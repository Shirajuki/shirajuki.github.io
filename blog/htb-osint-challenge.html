<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="content-security-policy" content=""><title>[HTB] OSINT CHALLENGE TIME by @sinfulz!</title><meta property="og:title" content="[HTB] OSINT CHALLENGE TIME by @sinfulz!" data-svelte="svelte-15w3rt">
	<link href="/_app/immutable/assets/__layout-8983cb90.css" rel="stylesheet">
	<link href="/_app/immutable/assets/layout-1c8f6cd0.css" rel="stylesheet">
	<link rel="modulepreload" href="/_app/immutable/start-81623720.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/index-2b5eadba.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/index-af51f98b.js">
	<link rel="modulepreload" href="/_app/immutable/pages/__layout.svelte-e4fb7ac9.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/stores-f88c56d4.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/index-94d4402f.js">
	<link rel="modulepreload" href="/_app/immutable/pages/blog/htb-osint-challenge.md-b71ebee2.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/layout-4590ce8c.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/utils-e126d158.js">
  </head>
  <body>
    <div>


<header class="show svelte-fvi1vf"><div class="corner svelte-fvi1vf"><a sveltekit:prefetch href="/" class="svelte-fvi1vf"><img src="/_app/immutable/assets/logo-30cfdbde.png" alt="Logo" class="svelte-fvi1vf"></a></div>

  <nav class="svelte-fvi1vf"><ul class="svelte-fvi1vf"><li class="svelte-fvi1vf"><a sveltekit:prefetch href="/" class="svelte-fvi1vf">Home</a></li>
      <li class="svelte-fvi1vf"><a sveltekit:prefetch href="/about" class="svelte-fvi1vf">About</a></li>
      <li class="svelte-fvi1vf active"><a sveltekit:prefetch href="/blog" class="svelte-fvi1vf">Blog</a></li></ul></nav>

  <div class="corner svelte-fvi1vf"></div>
</header>



<main class="svelte-2wbpbt">

<section class="content"><div><h1>[HTB] OSINT CHALLENGE TIME by @sinfulz!</h1>

  <p>February 28, 2021
    ·
    <span>Category: <a href="/blog/category/writeup">writeup</a></span></p>

  <p>Tags:
    <span><a href="/blog/tags/osint">osint</a>
      </span></p></div>

<h3 id="the-challenge-description-is"><a href="#the-challenge-description-is">The challenge description is:</a></h3>
<blockquote><p>Yummy Crusty Pizza have been working on their secret recipe for over two decades, serving only the best pizza in the city. A hacker recently broke into their OLD database and dumped their recipe online, can you retrieve it?</p></blockquote>
<p><strong>Beware of errors and bad practices as this my first ever write up, written for the OSINT challenge made by @s1nfulz and @0xLegacyy</strong></p>
<p>As this is an OSINT challenge, the first thing to be done is to find the website and I began to dork the google.
After multiple attempts the term <code>intext:&quot;Yummy Crusty Pizza&quot;</code> gave the result: <a href="https://www.yummycrustypizza.com/" rel="noopener" class="text-link" target="_blank">https://www.yummycrustypizza.com/</a>
<img src="https://i.imgur.com/8rXiZgP.png" alt="Google search on yummy crusty pizza"></p>
<p>Going to the site greets us to a templatemo site, and the one thing that pops out is the “database” navigation
<img src="https://i.imgur.com/CRPcviv.jpg" alt="Yummy Crusty Pizza website"></p>
<p>Upon navigating to the database site (<a href="https://www.yummycrustypizza.com/database" rel="noopener" class="text-link" target="_blank">https://www.yummycrustypizza.com/database</a>), we see that it is taken down:
<img src="https://i.imgur.com/ibBmOkt.png" alt="Database page of Yummy Crusty Pizza"></p>
<p>Knowing that the <code>/database</code> was taken down, I began checking the webarchive for an archivation of the page. (which there is)
<img src="https://i.imgur.com/f2cetoX.png" alt="List over the Web-archives">
<img src="https://i.imgur.com/mlxcFu4.png" alt="The webarchive of the database page"></p>
<p>We see a dump of the user database with hashed password of 6 users here, pasting the dump on to <a href="https://crackstation.net/" rel="noopener" class="text-link" target="_blank">https://crackstation.net/</a> we get the password for the user <code>sinfulz</code> which is <code>password5</code>.
<img src="https://i.imgur.com/TteudjO.png" alt="Crackstation on the hashes"></p>
<p>Knowing the password I try to find a place to login with the password. The first thing was to pop up gobuster to fuzzsearch the directory and routes.
Doing this we find the route <a href="https://www.yummycrustypizza.com/logs" rel="noopener" class="text-link" target="_blank">https://www.yummycrustypizza.com/logs</a>, however the combination of username and password doesn’t work. Releasing this, I try to find other clues.</p>
<p>Looking at the footer we see links to different social media accounts for Yummy Crusty Pizza
<img src="https://i.imgur.com/Km6uSV1.png" alt="Social media icons"></p>
<ul class="list"><li><a href="https://github.com/yummycrustypizza" rel="noopener" class="text-link" target="_blank">https://github.com/yummycrustypizza</a></li>
<li><a href="https://www.pinterest.com.au/yummycrustypizza/?invite_code=4d3b280567034fc4832010e537b2c631&sender=777434091833570390" rel="noopener" class="text-link" target="_blank">https://www.pinterest.com.au/yummycrustypizza/?invite_code=4d3b280567034fc4832010e537b2c631&amp;sender=777434091833570390</a></li>
<li><a href="https://www.instagram.com/yummycrustypizza/" rel="noopener" class="text-link" target="_blank">https://www.instagram.com/yummycrustypizza/</a></li>
<li><a href="https://twitter.com/YMMYCRSTYPZZA" rel="noopener" class="text-link" target="_blank">https://twitter.com/YMMYCRSTYPZZA</a></li></ul>
<p>Going to the sites we see that there’s nothing interesting on the github and pinterest accounts. However the instagram accounts gives us our first “fake flag”: <code>SINFULZ{We&#39;re_n0_str4ng3rs_t0_l0v3}</code> and the twitter account we find this interesting post:
<img src="https://i.imgur.com/hWmeJfW.png" alt="Twitter page"></p>
<p>Knowing that the dump is located in pastebin, we go to the site <a href="https://pastebin.com/BvatWyq8" rel="noopener" class="text-link" target="_blank">https://pastebin.com/BvatWyq8</a>:
<img src="https://i.imgur.com/rc1mtaT.png" alt="Pastebin">
And there the secret recipe is found at <a href="https://cryptobin.co/j5h5l4y8" rel="noopener" class="text-link" target="_blank">https://cryptobin.co/j5h5l4y8</a>
Going to the site we find out that we need a password to unlock the file.
<img src="https://i.imgur.com/vBYWN3j.png" alt="Cryptobin">
Remembering the password we’ve found earlier, <code>password5</code>, unlocks us the file and there we find our real flag: <code>SINFULZ{DUMPED_SECRETS_ON_PUBLIC_SITES_ARE_REAL}</code>
<img src="https://i.imgur.com/1FWZ98M.png" alt="Decrypted cryptobin showing the pizza recipe / flag"></p>
<p>Finding the flag, I set out my journey to find the easter egg made by Legacyy. However, after testing out all sort of google dorking, fuzz searches and hash/password bruteforcing, I failed miserably.</p>
<p>After reading another tweet from the creator of the challenge @s1nfulz, I see hint on the <code>favicon.ico</code> and the potential easter egg located in the file <code>sin_pizza_n-obg_2.ico</code>. However with the hint, I wasn’t able to find the easter egg after spamming all types of stegonography techniques on the given <code>favicon.ico</code> file, reverse image searching and fuzzing for the file <code>sin_pizza_n-obg_2.ico</code>. <em>(No I didn’t because I am an idiot)</em> My journey had to be ended here I thought…
<img src="https://i.imgur.com/pcLjHsd.png" alt="Sneak peek twitter feed on the easter egg"></p>
<p><em>Sike!</em> After some day (4 days) later, I’ve refreshed my thoughts and began to start searching for the easter egg once again. This time I focused more on the stegonography part instead of OSINT. As usual stego challenges, I began running <code>strings</code> and there I found a big clue which made the next part quite trivial:</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">...
$w+W
)K(*
&amp;okp
easter egg here:xor
key: legacyy
:qou
#mhm
H#$l
...</code><!-- HTML_TAG_END --></pre>
<p>Knowing this I set up a python script to xor the file with the given key <code>legacyy</code>:</p>
<pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token comment"># Read the bytes</span>
a <span class="token operator">=</span> <span class="token string">b""</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"favicon.ico"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    a <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># Find index location of the string "easter"</span>
index <span class="token operator">=</span> a<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">b"easter"</span><span class="token punctuation">)</span>
<span class="token comment"># print(a[index:index+54])</span>
key <span class="token operator">=</span> <span class="token string">b"legacyy"</span> <span class="token comment"># key</span>
n <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment"># key offset</span>
<span class="token comment"># XOR and print output</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>index<span class="token operator">+</span><span class="token number">54</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    c <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>n<span class="token operator">%</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
    n<span class="token operator">+=</span><span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>This gives us the output:
<img src="https://i.imgur.com/CsiHL8Q.png" alt="Python script output"></p>
<ul class="list"><li>Easter egg is finally found: <code>waterproof toaster :)</code></li></ul>
<p>This wraps up my first ever writeup. I would like give lots of thanks to @s1nfulz and @0xLegacyy for a great beginner friendly OSINT challenge, and would love to take part in future challenges like this again</p>
<p>Thank you for reading!</p>
<h3 id="flags"><a href="#flags">Flags</a></h3>
<ul class="list"><li><strong>Fake flag:</strong> <code>SINFULZ{We&#39;re_n0_str4ng3rs_t0_l0v3}</code></li>
<li><strong>Real flag:</strong> <code>SINFULZ{DUMPED_SECRETS_ON_PUBLIC_SITES_ARE_REAL}</code></li>
<li><strong>Easter egg:</strong> <code>waterproof toaster :)</code></li></ul>
</section></main>

<footer class="svelte-1lfjegf"><p>Design by Shirajuki (2022)</p>
</footer>


		<script type="module" data-sveltekit-hydrate="1ywafxy">
		import { set_public_env, start } from "/_app/immutable/start-81623720.js";

		set_public_env({});

		start({
			target: document.querySelector('[data-sveltekit-hydrate="1ywafxy"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [0, 6],
				params: {},
				routeId: "blog/htb-osint-challenge"
			}
		});
	</script></div>
  </body>
</html>
